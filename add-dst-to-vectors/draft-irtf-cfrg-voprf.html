<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Oblivious Pseudorandom Functions (OPRFs) using Prime-Order Groups</title>
<meta content="Alex Davidson" name="author">
<meta content="Armando Faz-Hernandez" name="author">
<meta content="Nick Sullivan" name="author">
<meta content="Christopher A. Wood" name="author">
<meta content="
       An Oblivious Pseudorandom Function (OPRF) is a two-party protocol for
computing the output of a PRF. One party (the server) holds the PRF
secret key, and the other (the client) holds the PRF input. The
'obliviousness' property ensures that the server does not learn anything
about the client's input during the evaluation. The client should also
not learn anything about the server's secret PRF key. Optionally, OPRFs
can also satisfy a notion 'verifiability' (VOPRF). In this setting, the
client can verify that the server's output is indeed the result of
evaluating the underlying PRF with just a public key. This document
specifies OPRF and VOPRF constructions instantiated within prime-order
groups, including elliptic curves. 
    " name="description">
<meta content="xml2rfc 3.4.0" name="generator">
<meta content="Internet-Draft" name="keyword">
<meta content="draft-irtf-cfrg-voprf-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.4.0
    Python 3.8.5
    appdirs 1.4.4
    ConfigArgParse 1.2.3
    google-i18n-address 2.4.0
    html5lib 1.1
    intervaltree 3.0.2
    Jinja2 2.11.2
    kitchen 1.2.6
    lxml 4.5.0
    pycountry 19.8.18
    pyflakes 2.1.1
    PyYAML 5.3.1
    requests 2.22.0
    setuptools 45.2.0
    six 1.14.0
-->
<link href="draft-irtf-cfrg-voprf.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@import url('https://martinthomson.github.io/i-d-template/fonts.css');

html {
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --small-font-size: 14.5px;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  font-family: "Cabin Condensed", sans-serif;
  font-weight: 600;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
#title {
  padding: 1em 0 0.2em;
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1, h2, h3 {
  font-size: 22px;
  line-height: 26px;
}
h4, h5, h6 {
  font-size: 18px;
  line-height: 22px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
}
#abstract+p, #abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 18px;
  line-height: 24px;
}
p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}
dd.break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href].selfRef {
  color: var(--text-color);
}
a[href] {
  color: var(--link-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px 'Oxygen Mono', monospace;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
}
@media screen {
  pre {
    display: inline-block;
    overflow-x: auto;
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  pre + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
  table {
    display: inline-block;
    overflow-x: auto;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
tr:nth-child(2n) > td {
  background-color: var(--background-color);
}
tr:nth-child(2n+1) > td {
  background-color: var(--highlight-color);
}
thead+tbody > tr:nth-child(2n) > td {
  background-color: var(--highlight-color);
}
thead+tbody > tr:nth-child(2n+1) > td {
  background-color: var(--background-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  visibility: hidden;
  user-select: none;
}
a.pilcrow[href] { color: #ddd; }
a.pilcrow[href]:hover { text-decoration: none; }
@media screen {
  :hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 8em;
}
#identifiers dt {
  width: var(--identifier-width);
  margin: 0;
  clear: left;
  float: left;
  text-align: right;
}
#identifiers dd {
  margin: 0 0 0 calc(1em + var(--identifier-width));
  min-width: 5em;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
#toc nav ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
#toc nav li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
#toc a.xref {
  white-space: normal;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 500px) {
  .index ul {
    column-count: 2;
    column-gap: 20px;
  }
  .index ul ul {
    column-count: 1;
    column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}
address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc.active {
      opacity: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 8px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active nav {
    display: block;
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin-top: 2px;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  #toc nav > ul  {
    margin-bottom: 2em;
  }
  #toc ul {
    margin: 0 0 0 4px;
    font-size: var(--small-font-size);
  }
  #toc ul p, #toc ul li {
    margin: 2px 0;
    line-height: 22px;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Changes introduced to fix issues found during implementation */

/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}

/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin: 8px 0.5em 0;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table .text-left, table .text-left {
  text-align: left;
}
table .text-center, table .text-center {
  text-align: center;
}
table .text-right, table .text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 20em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Give the table caption label the same styling as the figcaption */

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  dd {
    page-break-before: avoid;
  }
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
</style>

</head>
<body>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">OPRFs</td>
<td class="right">November 2020</td>
</tr></thead>
<tfoot><tr>
<td class="left">Davidson, et al.</td>
<td class="center">Expires 28 May 2021</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">Network Working Group</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-irtf-cfrg-voprf-latest</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2020-11-24" class="published">24 November 2020</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Informational</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2021-05-28">28 May 2021</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">A. Davidson</div>
<div class="org">Cloudflare</div>
</div>
<div class="author">
      <div class="author-name">A. Faz-Hernandez</div>
<div class="org">Cloudflare</div>
</div>
<div class="author">
      <div class="author-name">N. Sullivan</div>
<div class="org">Cloudflare</div>
</div>
<div class="author">
      <div class="author-name">C.A. Wood</div>
<div class="org">Cloudflare</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Oblivious Pseudorandom Functions (OPRFs) using Prime-Order Groups</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">An Oblivious Pseudorandom Function (OPRF) is a two-party protocol for
computing the output of a PRF. One party (the server) holds the PRF
secret key, and the other (the client) holds the PRF input. The
'obliviousness' property ensures that the server does not learn anything
about the client's input during the evaluation. The client should also
not learn anything about the server's secret PRF key. Optionally, OPRFs
can also satisfy a notion 'verifiability' (VOPRF). In this setting, the
client can verify that the server's output is indeed the result of
evaluating the underlying PRF with just a public key. This document
specifies OPRF and VOPRF constructions instantiated within prime-order
groups, including elliptic curves.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-discussion-venues">
<a href="#name-discussion-venues" class="section-name selfRef">Discussion Venues</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">Source for this draft and an issue tracker can be found at
  <span><a href="https://github.com/cfrg/draft-irtf-cfrg-voprf">https://github.com/cfrg/draft-irtf-cfrg-voprf</a></span>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 28 May 2021.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2020 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Simplified BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Simplified BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulEmpty">
<li class="compact toc ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1"><a href="#section-1" class="xref">1</a>.  <a href="#name-introduction" class="xref">Introduction</a><a href="#section-toc.1-1.1.1" class="pilcrow">¶</a></p>
<ul class="compact toc ulEmpty">
<li class="compact toc ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="xref">1.1</a>.  <a href="#name-change-log" class="xref">Change log</a><a href="#section-toc.1-1.1.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="compact toc ulEmpty" id="section-toc.1-1.1.2.2">
                <p id="section-toc.1-1.1.2.2.1" class="keepWithNext"><a href="#section-1.2" class="xref">1.2</a>.  <a href="#name-terminology" class="xref">Terminology</a><a href="#section-toc.1-1.1.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="compact toc ulEmpty" id="section-toc.1-1.1.2.3">
                <p id="section-toc.1-1.1.2.3.1" class="keepWithNext"><a href="#section-1.3" class="xref">1.3</a>.  <a href="#name-requirements" class="xref">Requirements</a><a href="#section-toc.1-1.1.2.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="xref">2</a>.  <a href="#name-preliminaries" class="xref">Preliminaries</a><a href="#section-toc.1-1.2.1" class="pilcrow">¶</a></p>
<ul class="compact toc ulEmpty">
<li class="compact toc ulEmpty" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1"><a href="#section-2.1" class="xref">2.1</a>.  <a href="#name-prime-order-group-api" class="xref">Prime-order group API</a><a href="#section-toc.1-1.2.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="compact toc ulEmpty" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1"><a href="#section-2.2" class="xref">2.2</a>.  <a href="#name-other-conventions" class="xref">Other conventions</a><a href="#section-toc.1-1.2.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="xref">3</a>.  <a href="#name-oprf-protocol" class="xref">OPRF Protocol</a><a href="#section-toc.1-1.3.1" class="pilcrow">¶</a></p>
<ul class="compact toc ulEmpty">
<li class="compact toc ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="xref">3.1</a>.  <a href="#name-overview" class="xref">Overview</a><a href="#section-toc.1-1.3.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="compact toc ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="xref">3.2</a>.  <a href="#name-context-setup" class="xref">Context Setup</a><a href="#section-toc.1-1.3.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="compact toc ulEmpty" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="xref">3.3</a>.  <a href="#name-data-types" class="xref">Data Types</a><a href="#section-toc.1-1.3.2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="compact toc ulEmpty" id="section-toc.1-1.3.2.4">
                <p id="section-toc.1-1.3.2.4.1"><a href="#section-3.4" class="xref">3.4</a>.  <a href="#name-context-apis" class="xref">Context APIs</a><a href="#section-toc.1-1.3.2.4.1" class="pilcrow">¶</a></p>
<ul class="compact toc ulEmpty">
<li class="compact toc ulEmpty" id="section-toc.1-1.3.2.4.2.1">
                    <p id="section-toc.1-1.3.2.4.2.1.1"><a href="#section-3.4.1" class="xref">3.4.1</a>.  <a href="#name-server-context" class="xref">Server Context</a><a href="#section-toc.1-1.3.2.4.2.1.1" class="pilcrow">¶</a></p>
</li>
                  <li class="compact toc ulEmpty" id="section-toc.1-1.3.2.4.2.2">
                    <p id="section-toc.1-1.3.2.4.2.2.1"><a href="#section-3.4.2" class="xref">3.4.2</a>.  <a href="#name-verifiableservercontext" class="xref">VerifiableServerContext</a><a href="#section-toc.1-1.3.2.4.2.2.1" class="pilcrow">¶</a></p>
</li>
                  <li class="compact toc ulEmpty" id="section-toc.1-1.3.2.4.2.3">
                    <p id="section-toc.1-1.3.2.4.2.3.1"><a href="#section-3.4.3" class="xref">3.4.3</a>.  <a href="#name-client-context" class="xref">Client Context</a><a href="#section-toc.1-1.3.2.4.2.3.1" class="pilcrow">¶</a></p>
</li>
                  <li class="compact toc ulEmpty" id="section-toc.1-1.3.2.4.2.4">
                    <p id="section-toc.1-1.3.2.4.2.4.1"><a href="#section-3.4.4" class="xref">3.4.4</a>.  <a href="#name-verifiableclientcontext" class="xref">VerifiableClientContext</a><a href="#section-toc.1-1.3.2.4.2.4.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-ciphersuites" class="xref">Ciphersuites</a><a href="#section-toc.1-1.4.1" class="pilcrow">¶</a></p>
<ul class="compact toc ulEmpty">
<li class="compact toc ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="xref">4.1</a>.  <a href="#name-oprfristretto255-sha-512" class="xref">OPRF(ristretto255, SHA-512)</a><a href="#section-toc.1-1.4.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="compact toc ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="xref">4.2</a>.  <a href="#name-oprfdecaf448-sha-512" class="xref">OPRF(decaf448, SHA-512)</a><a href="#section-toc.1-1.4.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="compact toc ulEmpty" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="xref">4.3</a>.  <a href="#name-oprfp-256-sha-256" class="xref">OPRF(P-256, SHA-256)</a><a href="#section-toc.1-1.4.2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="compact toc ulEmpty" id="section-toc.1-1.4.2.4">
                <p id="section-toc.1-1.4.2.4.1"><a href="#section-4.4" class="xref">4.4</a>.  <a href="#name-oprfp-384-sha-512" class="xref">OPRF(P-384, SHA-512)</a><a href="#section-toc.1-1.4.2.4.1" class="pilcrow">¶</a></p>
</li>
              <li class="compact toc ulEmpty" id="section-toc.1-1.4.2.5">
                <p id="section-toc.1-1.4.2.5.1"><a href="#section-4.5" class="xref">4.5</a>.  <a href="#name-oprfp-521-sha-512" class="xref">OPRF(P-521, SHA-512)</a><a href="#section-toc.1-1.4.2.5.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-security-considerations" class="xref">Security Considerations</a><a href="#section-toc.1-1.5.1" class="pilcrow">¶</a></p>
<ul class="compact toc ulEmpty">
<li class="compact toc ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="xref">5.1</a>.  <a href="#name-security-properties" class="xref">Security properties</a><a href="#section-toc.1-1.5.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="compact toc ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="xref">5.2</a>.  <a href="#name-cryptographic-security" class="xref">Cryptographic security</a><a href="#section-toc.1-1.5.2.2.1" class="pilcrow">¶</a></p>
<ul class="compact toc ulEmpty">
<li class="compact toc ulEmpty" id="section-toc.1-1.5.2.2.2.1">
                    <p id="section-toc.1-1.5.2.2.2.1.1"><a href="#section-5.2.1" class="xref">5.2.1</a>.  <a href="#name-computational-hardness-assu" class="xref">Computational hardness assumptions</a><a href="#section-toc.1-1.5.2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
                  <li class="compact toc ulEmpty" id="section-toc.1-1.5.2.2.2.2">
                    <p id="section-toc.1-1.5.2.2.2.2.1"><a href="#section-5.2.2" class="xref">5.2.2</a>.  <a href="#name-protocol-security" class="xref">Protocol security</a><a href="#section-toc.1-1.5.2.2.2.2.1" class="pilcrow">¶</a></p>
</li>
                  <li class="compact toc ulEmpty" id="section-toc.1-1.5.2.2.2.3">
                    <p id="section-toc.1-1.5.2.2.2.3.1"><a href="#section-5.2.3" class="xref">5.2.3</a>.  <a href="#name-q-strong-dh-oracle" class="xref">Q-strong-DH oracle</a><a href="#section-toc.1-1.5.2.2.2.3.1" class="pilcrow">¶</a></p>
</li>
                  <li class="compact toc ulEmpty" id="section-toc.1-1.5.2.2.2.4">
                    <p id="section-toc.1-1.5.2.2.2.4.1"><a href="#section-5.2.4" class="xref">5.2.4</a>.  <a href="#name-implications-for-ciphersuit" class="xref">Implications for ciphersuite choices</a><a href="#section-toc.1-1.5.2.2.2.4.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulEmpty" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a href="#section-5.3" class="xref">5.3</a>.  <a href="#name-hashing-to-curve" class="xref">Hashing to curve</a><a href="#section-toc.1-1.5.2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="compact toc ulEmpty" id="section-toc.1-1.5.2.4">
                <p id="section-toc.1-1.5.2.4.1"><a href="#section-5.4" class="xref">5.4</a>.  <a href="#name-timing-leaks" class="xref">Timing Leaks</a><a href="#section-toc.1-1.5.2.4.1" class="pilcrow">¶</a></p>
</li>
              <li class="compact toc ulEmpty" id="section-toc.1-1.5.2.5">
                <p id="section-toc.1-1.5.2.5.1"><a href="#section-5.5" class="xref">5.5</a>.  <a href="#name-key-rotation" class="xref">Key rotation</a><a href="#section-toc.1-1.5.2.5.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-additive-blinding" class="xref">Additive blinding</a><a href="#section-toc.1-1.6.1" class="pilcrow">¶</a></p>
<ul class="compact toc ulEmpty">
<li class="compact toc ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="xref">6.1</a>.  <a href="#name-preprocess" class="xref">Preprocess</a><a href="#section-toc.1-1.6.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="compact toc ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="xref">6.2</a>.  <a href="#name-additiveblind" class="xref">AdditiveBlind</a><a href="#section-toc.1-1.6.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="compact toc ulEmpty" id="section-toc.1-1.6.2.3">
                <p id="section-toc.1-1.6.2.3.1"><a href="#section-6.3" class="xref">6.3</a>.  <a href="#name-additiveunblind" class="xref">AdditiveUnblind</a><a href="#section-toc.1-1.6.2.3.1" class="pilcrow">¶</a></p>
<ul class="compact toc ulEmpty">
<li class="compact toc ulEmpty" id="section-toc.1-1.6.2.3.2.1">
                    <p id="section-toc.1-1.6.2.3.2.1.1"><a href="#section-6.3.1" class="xref">6.3.1</a>.  <a href="#name-parameter-commitments" class="xref">Parameter Commitments</a><a href="#section-toc.1-1.6.2.3.2.1.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref">7</a>.  <a href="#name-acknowledgements" class="xref">Acknowledgements</a><a href="#section-toc.1-1.7.1" class="pilcrow">¶</a></p>
</li>
          <li class="compact toc ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="xref">8</a>.  <a href="#name-references" class="xref">References</a><a href="#section-toc.1-1.8.1" class="pilcrow">¶</a></p>
<ul class="compact toc ulEmpty">
<li class="compact toc ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="xref">8.1</a>.  <a href="#name-normative-references" class="xref">Normative References</a><a href="#section-toc.1-1.8.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="compact toc ulEmpty" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a href="#section-8.2" class="xref">8.2</a>.  <a href="#name-informative-references" class="xref">Informative References</a><a href="#section-toc.1-1.8.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-appendix.a" class="xref">Appendix A</a>.  <a href="#name-test-vectors" class="xref">Test Vectors</a><a href="#section-toc.1-1.9.1" class="pilcrow">¶</a></p>
<ul class="compact toc ulEmpty">
<li class="compact toc ulEmpty" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a href="#section-a.1" class="xref">A.1</a>.  <a href="#name-oprfristretto255-sha-512-2" class="xref">OPRF(ristretto255, SHA-512)</a><a href="#section-toc.1-1.9.2.1.1" class="pilcrow">¶</a></p>
<ul class="compact toc ulEmpty">
<li class="compact toc ulEmpty" id="section-toc.1-1.9.2.1.2.1">
                    <p id="section-toc.1-1.9.2.1.2.1.1"><a href="#section-a.1.1" class="xref">A.1.1</a>.  <a href="#name-base-mode" class="xref">Base Mode</a><a href="#section-toc.1-1.9.2.1.2.1.1" class="pilcrow">¶</a></p>
</li>
                  <li class="compact toc ulEmpty" id="section-toc.1-1.9.2.1.2.2">
                    <p id="section-toc.1-1.9.2.1.2.2.1"><a href="#section-a.1.2" class="xref">A.1.2</a>.  <a href="#name-verifiable-mode" class="xref">Verifiable Mode</a><a href="#section-toc.1-1.9.2.1.2.2.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulEmpty" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a href="#section-a.2" class="xref">A.2</a>.  <a href="#name-oprfdecaf448-sha-512-2" class="xref">OPRF(decaf448, SHA-512)</a><a href="#section-toc.1-1.9.2.2.1" class="pilcrow">¶</a></p>
<ul class="compact toc ulEmpty">
<li class="compact toc ulEmpty" id="section-toc.1-1.9.2.2.2.1">
                    <p id="section-toc.1-1.9.2.2.2.1.1"><a href="#section-a.2.1" class="xref">A.2.1</a>.  <a href="#name-base-mode-2" class="xref">Base Mode</a><a href="#section-toc.1-1.9.2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
                  <li class="compact toc ulEmpty" id="section-toc.1-1.9.2.2.2.2">
                    <p id="section-toc.1-1.9.2.2.2.2.1"><a href="#section-a.2.2" class="xref">A.2.2</a>.  <a href="#name-verifiable-mode-2" class="xref">Verifiable Mode</a><a href="#section-toc.1-1.9.2.2.2.2.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulEmpty" id="section-toc.1-1.9.2.3">
                <p id="section-toc.1-1.9.2.3.1"><a href="#section-a.3" class="xref">A.3</a>.  <a href="#name-oprfp-256-sha-256-2" class="xref">OPRF(P-256, SHA-256)</a><a href="#section-toc.1-1.9.2.3.1" class="pilcrow">¶</a></p>
<ul class="compact toc ulEmpty">
<li class="compact toc ulEmpty" id="section-toc.1-1.9.2.3.2.1">
                    <p id="section-toc.1-1.9.2.3.2.1.1"><a href="#section-a.3.1" class="xref">A.3.1</a>.  <a href="#name-base-mode-3" class="xref">Base Mode</a><a href="#section-toc.1-1.9.2.3.2.1.1" class="pilcrow">¶</a></p>
</li>
                  <li class="compact toc ulEmpty" id="section-toc.1-1.9.2.3.2.2">
                    <p id="section-toc.1-1.9.2.3.2.2.1"><a href="#section-a.3.2" class="xref">A.3.2</a>.  <a href="#name-verifiable-mode-3" class="xref">Verifiable Mode</a><a href="#section-toc.1-1.9.2.3.2.2.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulEmpty" id="section-toc.1-1.9.2.4">
                <p id="section-toc.1-1.9.2.4.1"><a href="#section-a.4" class="xref">A.4</a>.  <a href="#name-oprfp-384-sha-512-2" class="xref">OPRF(P-384, SHA-512)</a><a href="#section-toc.1-1.9.2.4.1" class="pilcrow">¶</a></p>
<ul class="compact toc ulEmpty">
<li class="compact toc ulEmpty" id="section-toc.1-1.9.2.4.2.1">
                    <p id="section-toc.1-1.9.2.4.2.1.1"><a href="#section-a.4.1" class="xref">A.4.1</a>.  <a href="#name-base-mode-4" class="xref">Base Mode</a><a href="#section-toc.1-1.9.2.4.2.1.1" class="pilcrow">¶</a></p>
</li>
                  <li class="compact toc ulEmpty" id="section-toc.1-1.9.2.4.2.2">
                    <p id="section-toc.1-1.9.2.4.2.2.1"><a href="#section-a.4.2" class="xref">A.4.2</a>.  <a href="#name-verifiable-mode-4" class="xref">Verifiable Mode</a><a href="#section-toc.1-1.9.2.4.2.2.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulEmpty" id="section-toc.1-1.9.2.5">
                <p id="section-toc.1-1.9.2.5.1"><a href="#section-a.5" class="xref">A.5</a>.  <a href="#name-oprfp-521-sha-512-2" class="xref">OPRF(P-521, SHA-512)</a><a href="#section-toc.1-1.9.2.5.1" class="pilcrow">¶</a></p>
<ul class="compact toc ulEmpty">
<li class="compact toc ulEmpty" id="section-toc.1-1.9.2.5.2.1">
                    <p id="section-toc.1-1.9.2.5.2.1.1"><a href="#section-a.5.1" class="xref">A.5.1</a>.  <a href="#name-base-mode-5" class="xref">Base Mode</a><a href="#section-toc.1-1.9.2.5.2.1.1" class="pilcrow">¶</a></p>
</li>
                  <li class="compact toc ulEmpty" id="section-toc.1-1.9.2.5.2.2">
                    <p id="section-toc.1-1.9.2.5.2.2.1"><a href="#section-a.5.2" class="xref">A.5.2</a>.  <a href="#name-verifiable-mode-5" class="xref">Verifiable Mode</a><a href="#section-toc.1-1.9.2.5.2.2.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-appendix.b" class="xref"></a><a href="#name-authors-addresses" class="xref">Authors' Addresses</a><a href="#section-toc.1-1.10.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">A pseudorandom function (PRF) F(k, x) is an efficiently computable
function taking a private key k and a value x as input. This function is
pseudorandom if the keyed function K(_) = F(K, _) is indistinguishable
from a randomly sampled function acting on the same domain and range as
K(). An oblivious PRF (OPRF) is a two-party protocol between a server
and a client, where the server holds a PRF key k and the client holds
some input x. The protocol allows both parties to cooperate in computing
F(k, x) such that: the client learns F(k, x) without learning anything
about k; and the server does not learn anything about x or F(k, x).
A Verifiable OPRF (VOPRF) is an OPRF wherein the server can prove to the
client that F(k, x) was computed using the key k.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">The usage of OPRFs has been demonstrated in constructing a number of
applications: password-protected secret sharing schemes <span>[<a href="#JKKX16" class="xref">JKKX16</a>]</span>;
privacy-preserving password stores <span>[<a href="#SJKS17" class="xref">SJKS17</a>]</span>; and
password-authenticated key exchange or PAKE <span>[<a href="#I-D.irtf-cfrg-opaque" class="xref">I-D.irtf-cfrg-opaque</a>]</span>. A VOPRF is
necessary in some applications, e.g., the Privacy Pass protocol
<span>[<a href="#I-D.davidson-pp-protocol" class="xref">I-D.davidson-pp-protocol</a>]</span>, wherein this VOPRF is used to generate
one-time authentication tokens to bypass CAPTCHA challenges. VOPRFs have
also been used for password-protected secret sharing schemes e.g.
<span>[<a href="#JKK14" class="xref">JKK14</a>]</span>.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">This document introduces an OPRF protocol built in prime-order groups,
applying to finite fields of prime-order and also elliptic curve (EC)
groups. The protocol has the option of being extended to a VOPRF with
the addition of a NIZK proof for proving discrete log equality
relations. This proof demonstrates correctness of the computation, using
a known public key that serves as a commitment to the server's secret
key. The document describes the protocol, the public-facing API, and its
security properties.<a href="#section-1-3" class="pilcrow">¶</a></p>
<div id="change-log">
<section id="section-1.1">
        <h3 id="name-change-log">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-change-log" class="section-name selfRef">Change log</a>
        </h3>
<p id="section-1.1-1"><a href="https://tools.ietf.org/html/draft-irtf-cfrg-voprf-05">draft-05</a>:<a href="#section-1.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.1-2.1">Move to ristretto255 and decaf448 ciphersuites.<a href="#section-1.1-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-2.2">Clean up ciphersuite definitions.<a href="#section-1.1-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-2.3">Pin domain separation tag construction to draft version.<a href="#section-1.1-2.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-2.4">Move key generation outside of context construction functions.<a href="#section-1.1-2.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-2.5">Editorial changes.<a href="#section-1.1-2.5" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-1.1-3"><a href="https://tools.ietf.org/html/draft-irtf-cfrg-voprf-04">draft-04</a>:<a href="#section-1.1-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.1-4.1">Introduce Client and Server contexts for controlling verifiability and
required functionality.<a href="#section-1.1-4.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-4.2">Condense API.<a href="#section-1.1-4.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-4.3">Remove batching from standard functionality (included as an extension)<a href="#section-1.1-4.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-4.4">Add Curve25519 and P-256 ciphersuites for applications that prevent
strong-DH oracle attacks.<a href="#section-1.1-4.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-4.5">Provide explicit prime-order group API and instantiation advice for
each ciphersuite.<a href="#section-1.1-4.5" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-4.6">Proof-of-concept implementation in sage.<a href="#section-1.1-4.6" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-4.7">Remove privacy considerations advice as this depends on applications.<a href="#section-1.1-4.7" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-1.1-5"><a href="https://tools.ietf.org/html/draft-irtf-cfrg-voprf-03">draft-03</a>:<a href="#section-1.1-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.1-6.1">Certify public key during VerifiableFinalize<a href="#section-1.1-6.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-6.2">Remove protocol integration advice<a href="#section-1.1-6.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-6.3">Add text discussing how to perform domain separation<a href="#section-1.1-6.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-6.4">Drop OPRF_/VOPRF_ prefix from algorithm names<a href="#section-1.1-6.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-6.5">Make prime-order group assumption explicit<a href="#section-1.1-6.5" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-6.6">Changes to algorithms accepting batched inputs<a href="#section-1.1-6.6" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-6.7">Changes to construction of batched DLEQ proofs<a href="#section-1.1-6.7" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-6.8">Updated ciphersuites to be consistent with hash-to-curve and added
OPRF specific ciphersuites<a href="#section-1.1-6.8" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-1.1-7"><a href="https://tools.ietf.org/html/draft-irtf-cfrg-voprf-02">draft-02</a>:<a href="#section-1.1-7" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.1-8.1">Added section discussing cryptographic security and static DH oracles<a href="#section-1.1-8.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-8.2">Updated batched proof algorithms<a href="#section-1.1-8.2" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-1.1-9"><a href="https://tools.ietf.org/html/draft-irtf-cfrg-voprf-01">draft-01</a>:<a href="#section-1.1-9" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.1-10.1">Updated ciphersuites to be in line with
https://tools.ietf.org/html/draft-irtf-cfrg-hash-to-curve-04<a href="#section-1.1-10.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-10.2">Made some necessary modular reductions more explicit<a href="#section-1.1-10.2" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="terminology">
<section id="section-1.2">
        <h3 id="name-terminology">
<a href="#section-1.2" class="section-number selfRef">1.2. </a><a href="#name-terminology" class="section-name selfRef">Terminology</a>
        </h3>
<p id="section-1.2-1">The following terms are used throughout this document.<a href="#section-1.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.2-2.1">PRF: Pseudorandom Function.<a href="#section-1.2-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.2-2.2">OPRF: Oblivious Pseudorandom Function.<a href="#section-1.2-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.2-2.3">VOPRF: Verifiable Oblivious Pseudorandom Function.<a href="#section-1.2-2.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.2-2.4">Client: Protocol initiator. Learns pseudorandom function evaluation as
the output of the protocol.<a href="#section-1.2-2.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.2-2.5">Server: Computes the pseudorandom function over a secret key. Learns
nothing about the client's input.<a href="#section-1.2-2.5" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.2-2.6">NIZK: Non-interactive zero knowledge.<a href="#section-1.2-2.6" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.2-2.7">DLEQ: Discrete Logarithm Equality.<a href="#section-1.2-2.7" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="requirements">
<section id="section-1.3">
        <h3 id="name-requirements">
<a href="#section-1.3" class="section-number selfRef">1.3. </a><a href="#name-requirements" class="section-name selfRef">Requirements</a>
        </h3>
<p id="section-1.3-1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL
NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED",
"MAY", and "OPTIONAL" in this document are to be interpreted as
described in BCP 14 <span>[<a href="#RFC2119" class="xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="xref">RFC8174</a>]</span> when, and only when, they
appear in all capitals, as shown here.<a href="#section-1.3-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="preliminaries">
<section id="section-2">
      <h2 id="name-preliminaries">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-preliminaries" class="section-name selfRef">Preliminaries</a>
      </h2>
<p id="section-2-1">The (V)OPRF protocol in this document has two primary dependencies:<a href="#section-2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2-2.1">
          <code>GG</code>: A prime-order group implementing the API described below in <a href="#pog" class="xref">Section 2.1</a>,
with base point defined in the corresponding reference for each group.
(See <a href="#ciphersuites" class="xref">Section 4</a> for these base points.)<a href="#section-2-2.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-2.2">
          <code>Hash</code>: A cryptographic hash function that is indifferentiable from a
Random Oracle, whose output length is Nh bytes long.<a href="#section-2-2.2" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-2-3"><a href="#ciphersuites" class="xref">Section 4</a> specifies ciphersuites as combinations of <code>GG</code> and <code>Hash</code>.<a href="#section-2-3" class="pilcrow">¶</a></p>
<div id="pog">
<section id="section-2.1">
        <h3 id="name-prime-order-group-api">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-prime-order-group-api" class="section-name selfRef">Prime-order group API</a>
        </h3>
<p id="section-2.1-1">In this document, we assume the construction of an additive, prime-order
group <code>GG</code> for performing all mathematical operations. Such groups are
uniquely determined by the choice of the prime <code>p</code> that defines the
order of the group. We use <code>GF(p)</code> to represent the finite field of
order <code>p</code>. For the purpose of understanding and implementing this
document, we take <code>GF(p)</code> to be equal to the set of integers defined by
<code>{0, 1, ..., p-1}</code>.<a href="#section-2.1-1" class="pilcrow">¶</a></p>
<p id="section-2.1-2">The fundamental group operation is addition <code>+</code> with identity element
<code>I</code>. For any elements <code>A</code> and <code>B</code> of the group <code>GG</code>, <code>A + B = B + A</code> is
also a member of <code>GG</code>. Also, for any <code>A</code> in <code>GG</code>, there exists an element
<code>-A</code> such that <code>A + (-A) = (-A) + A = I</code>. Scalar multiplication is
equivalent to the repeated application of the group operation on an
element A with itself <code>r-1</code> times, this is denoted as <code>r*A = A + ... +
A</code>. For any element <code>A</code>, the equality <code>p*A=I</code> holds. Scalar base multiplication
is equivalent to the repeated application of the group operation on the
base point with itself <code>r-1</code> times, this is denoted as <code>ScalarBaseMult(r)</code>.
The set of scalars corresponds to <code>GF(p)</code>.<a href="#section-2.1-2" class="pilcrow">¶</a></p>
<p id="section-2.1-3">We now detail a number of member functions that can be invoked on a
prime-order group.<a href="#section-2.1-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.1-4.1">Order(): Outputs the order of GG (i.e. <code>p</code>).<a href="#section-2.1-4.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.1-4.2">Identity(): Outputs the identity element of the group (i.e. <code>I</code>).<a href="#section-2.1-4.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.1-4.3">SerializeElement(A): A member function of <code>GG</code> that maps a group element <code>A</code>
to a unique byte array <code>buf</code> of fixed length <code>Ne</code>.<a href="#section-2.1-4.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.1-4.4">DeserializeElement(buf): A member function of <code>GG</code> that maps a byte array
<code>buf</code> to a group element <code>A</code>, or fails if the input is not a valid
byte representation of an element.<a href="#section-2.1-4.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.1-4.5">SerializeScalar(s): A member function of <code>GG</code> that maps a scalar element <code>s</code>
to a unique byte array <code>buf</code> of fixed length <code>Ns</code>.<a href="#section-2.1-4.5" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.1-4.6">DeserializeScalar(buf): A member function of <code>GG</code> that maps a byte array
<code>buf</code> to a scalar <code>s</code>, or fails if the input is not a valid byte
representation of a scalar.<a href="#section-2.1-4.6" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.1-4.7">HashToGroup(x): A member function of <code>GG</code> that deterministically maps
an array of bytes <code>x</code> to an element of <code>GG</code>. The map must ensure that,
for any adversary receiving <code>R = HashToGroup(x)</code>, it is
computationally difficult to reverse the mapping. Examples of hash to
group functions satisfying this property are described for prime-order
(sub)groups of elliptic curves, see <span>[<a href="#I-D.irtf-cfrg-hash-to-curve" class="xref">I-D.irtf-cfrg-hash-to-curve</a>]</span>.<a href="#section-2.1-4.7" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.1-4.8">HashToScalar(x): A member function of <code>GG</code> that deterministically maps
an array of bytes <code>x</code> to an element in GF(p). A recommended method
for its implementation is instantiating the hash to field function,
defined in <span>[<a href="#I-D.irtf-cfrg-hash-to-curve" class="xref">I-D.irtf-cfrg-hash-to-curve</a>]</span> setting the target field to GF(p).<a href="#section-2.1-4.8" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.1-4.9">RandomScalar(): A member function of <code>GG</code> that chooses at random a
non-zero element in GF(p).<a href="#section-2.1-4.9" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-2.1-5">It is convenient in cryptographic applications to instantiate such
prime-order groups using elliptic curves, such as those detailed in
<span>[<a href="#SEC2" class="xref">SEC2</a>]</span>. For some choices of elliptic curves (e.g. those detailed in
<span>[<a href="#RFC7748" class="xref">RFC7748</a>]</span>, which require accounting for cofactors) there are some
implementation issues that introduce inherent discrepancies between
standard prime-order groups and the elliptic curve instantiation. In
this document, all algorithms that we detail assume that the group is a
prime-order group, and this MUST be upheld by any implementer. That is,
any curve instantiation should be written such that any discrepancies
with a prime-order group instantiation are removed. See <a href="#ciphersuites" class="xref">Section 4</a>
for advice corresponding to the implementation of this interface for
specific definitions of elliptic curves.<a href="#section-2.1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="other-conventions">
<section id="section-2.2">
        <h3 id="name-other-conventions">
<a href="#section-2.2" class="section-number selfRef">2.2. </a><a href="#name-other-conventions" class="section-name selfRef">Other conventions</a>
        </h3>
<ul class="normal">
<li class="normal" id="section-2.2-1.1">For any object <code>x</code>, we write <code>len(x)</code> to denote its length in bytes.<a href="#section-2.2-1.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.2-1.2">For two byte arrays <code>x</code> and <code>y</code>, write <code>x || y</code> to denote their
concatenation.<a href="#section-2.2-1.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.2-1.3">I2OSP and OS2IP: Convert a byte array to and from a non-negative
integer as described in <span>[<a href="#RFC8017" class="xref">RFC8017</a>]</span>. Note that these functions
operate on byte arrays in big-endian byte order.<a href="#section-2.2-1.3" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-2.2-2">All algorithm descriptions are written in a Python-like pseudocode. We
use the <code>ABORT()</code> function for presentational clarity to denote the
process of terminating the algorithm or returning an error accordingly.
We also use the <code>CT_EQUAL(a, b)</code> function to represent constant-time
byte-wise equality between byte arrays <code>a</code> and <code>b</code>. This function
returns <code>true</code> if <code>a</code> and <code>b</code> are equal, and <code>false</code> otherwise.<a href="#section-2.2-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="protocol">
<section id="section-3">
      <h2 id="name-oprf-protocol">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-oprf-protocol" class="section-name selfRef">OPRF Protocol</a>
      </h2>
<p id="section-3-1">In this section, we define two OPRF variants: a base mode and verifiable
mode. In the base mode, a client and server interact to compute y =
F(skS, x), where x is the client's input, skS is the server's private
key, and y is the OPRF output. The client learns y and the server learns
nothing. In the verifiable mode, the client also gets proof that the
server used skS in computing the function.<a href="#section-3-1" class="pilcrow">¶</a></p>
<p id="section-3-2">To achieve verifiability, as in the original work of <span>[<a href="#JKK14" class="xref">JKK14</a>]</span>, we
provide a zero-knowledge proof that the key provided as input by the
server in the <code>Evaluate</code> function is the same key as it used to produce
their public key. As an example of the nature of attacks that this
prevents, this ensures that the server uses the same private key for
computing the VOPRF output and does not attempt to "tag" individual
servers with select keys. This proof must not reveal the server's
long-term private key to the client.<a href="#section-3-2" class="pilcrow">¶</a></p>
<p id="section-3-3">The following one-byte values distinguish between these two modes:<a href="#section-3-3" class="pilcrow">¶</a></p>
<table class="center" id="table-1">
        <caption><a href="#table-1" class="selfRef">Table 1</a></caption>
<thead>
          <tr>
            <th class="text-left" rowspan="1" colspan="1">Mode</th>
            <th class="text-left" rowspan="1" colspan="1">Value</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">modeBase</td>
            <td class="text-left" rowspan="1" colspan="1">0x00</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">modeVerifiable</td>
            <td class="text-left" rowspan="1" colspan="1">0x01</td>
          </tr>
        </tbody>
      </table>
<div id="protocol-overview">
<section id="section-3.1">
        <h3 id="name-overview">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-overview" class="section-name selfRef">Overview</a>
        </h3>
<p id="section-3.1-1">Both participants agree on the mode and a choice of ciphersuite that is
used before the protocol exchange. Once established, the core protocol
runs to compute <code>output = F(skS, input)</code> as follows:<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-3.1-2">
<pre>
   Client(pkS, input, info)                 Server(skS, pkS)
  ----------------------------------------------------------
    blind, blindedElement = Blind(input)

                       blindedElement
                        ----------&gt;

                  evaluatedElement, proof = Evaluate(skS, pkS, blindedElement)

                  evaluatedElement, proof
                        &lt;----------

    unblindedElement = Unblind(blind, evaluatedElement, blindedElement, pkS, proof)
    output = Finalize(input, unblindedElement, info)
</pre><a href="#section-3.1-2" class="pilcrow">¶</a>
</div>
<p id="section-3.1-3">In <code>Blind</code> the client generates a token and blinding data. The server
computes the (V)OPRF evaluation in <code>Evaluation</code> over the client's
blinded token. In <code>Unblind</code> the client unblinds the server response (and
verifies the server's proof if verifiability is required). In
<code>Finalize</code>, the client produces a byte array corresponding to the output
of the OPRF protocol.<a href="#section-3.1-3" class="pilcrow">¶</a></p>
<p id="section-3.1-4">Note that in the final output, the client computes Finalize over some
auxiliary input data <code>info</code>. This parameter SHOULD be used for domain
separation in the (V)OPRF protocol. Specifically, any system which has
multiple (V)OPRF applications should use separate auxiliary values to
ensure finalized outputs are separate. Guidance for constructing info
can be found in <span>[<a href="#I-D.irtf-cfrg-hash-to-curve" class="xref">I-D.irtf-cfrg-hash-to-curve</a>]</span>; Section 3.1.<a href="#section-3.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="context-setup">
<section id="section-3.2">
        <h3 id="name-context-setup">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-context-setup" class="section-name selfRef">Context Setup</a>
        </h3>
<p id="section-3.2-1">Both modes of the OPRF involve an offline setup phase. In this phase,
both the client and server create a context used for executing the
online phase of the protocol. Prior to this phase, keys (<code>skS</code>, <code>pkS</code>)
should be generated by calling a <code>KeyGen</code> function. <code>KeyGen</code>
generates a private and public key pair (<code>skS</code>, <code>pkS</code>), where <code>skS</code> is a
non-zero element chosen at random from the scalar field of the
corresponding group and <code>pkS = ScalarBaseMult(skS)</code>.<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<p id="section-3.2-2">The base mode setup functions for creating client and server contexts are below:<a href="#section-3.2-2" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-3.2-3">
<pre>
def SetupBaseServer(suite, skS):
  contextString = I2OSP(modeBase, 1) || I2OSP(suite.ID, 2)
  return ServerContext(contextString, skS)

def SetupBaseClient(suite):
  contextString = I2OSP(modeBase, 1) || I2OSP(suite.ID, 2)
  return ClientContext(contextString)
</pre><a href="#section-3.2-3" class="pilcrow">¶</a>
</div>
<p id="section-3.2-4">The verifiable mode setup functions for creating client and server
contexts are below:<a href="#section-3.2-4" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-3.2-5">
<pre>
def SetupVerifiableServer(suite, skS, pkS):
  contextString = I2OSP(modeVerifiable, 1) || I2OSP(suite.ID, 2)
  return VerifiableServerContext(contextString, skS)

def SetupVerifiableClient(suite, pkS):
  contextString = I2OSP(modeVerifiable, 1) || I2OSP(suite.ID, 2)
  return VerifiableClientContext(contextString, pkS)
</pre><a href="#section-3.2-5" class="pilcrow">¶</a>
</div>
<p id="section-3.2-6">Each setup function takes a ciphersuite from the list defined in
<a href="#ciphersuites" class="xref">Section 4</a>. Each ciphersuite has a two-byte field ID used to
identify the suite.<a href="#section-3.2-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="structs">
<section id="section-3.3">
        <h3 id="name-data-types">
<a href="#section-3.3" class="section-number selfRef">3.3. </a><a href="#name-data-types" class="section-name selfRef">Data Types</a>
        </h3>
<p id="section-3.3-1">The following is a list of data structures that are defined for
providing inputs and outputs for each of the context interfaces defined
in <a href="#api" class="xref">Section 3.4</a>. Data structure description uses TLS notation (see <span>[<a href="#RFC8446" class="xref">RFC8446</a>]</span>,
Section 3).<a href="#section-3.3-1" class="pilcrow">¶</a></p>
<p id="section-3.3-2">This document uses the types <code>Element</code> and <code>Scalar</code> to denote elements of the
group <code>GG</code> and its underlying scalar field <code>GF(p)</code>, respectively. For notational
clarity, <code>PublicKey</code> is an item of type <code>Element</code> and <code>PrivateKey</code> is an item
of type <code>Scalar</code>. <code>SerializedElement</code> and <code>SerializedScalar</code> are serialized
representations of <code>Element</code> and <code>Scalar</code> types of length <code>Ne</code> and <code>Ns</code>,
respectively; see <a href="#pog" class="xref">Section 2.1</a>. <code>ClientInput</code> is an opaque byte string of arbitrary
length. <code>Proof</code> is a sequence of two <code>SerializedScalar</code> elements, as shown below.<a href="#section-3.3-2" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-3.3-3">
<pre>
SerializedScalar Proof[2];
</pre><a href="#section-3.3-3" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="api">
<section id="section-3.4">
        <h3 id="name-context-apis">
<a href="#section-3.4" class="section-number selfRef">3.4. </a><a href="#name-context-apis" class="section-name selfRef">Context APIs</a>
        </h3>
<p id="section-3.4-1">In this section, we detail the APIs available on the client and server
(V)OPRF contexts.<a href="#section-3.4-1" class="pilcrow">¶</a></p>
<div id="server-context">
<section id="section-3.4.1">
          <h4 id="name-server-context">
<a href="#section-3.4.1" class="section-number selfRef">3.4.1. </a><a href="#name-server-context" class="section-name selfRef">Server Context</a>
          </h4>
<p id="section-3.4.1-1">The ServerContext encapsulates the context string constructed during
setup and the (V)OPRF key pair. It has three functions, <code>Evaluate</code>,
<code>FullEvaluate</code> and <code>VerifyFinalize</code> described below. <code>Evaluate</code> takes
serialized representations of blinded group elements from the client as inputs.<a href="#section-3.4.1-1" class="pilcrow">¶</a></p>
<p id="section-3.4.1-2"><code>FullEvaluate</code> takes ClientInput values, and it is useful for applications
that need to compute the whole OPRF protocol on the server side only.<a href="#section-3.4.1-2" class="pilcrow">¶</a></p>
<p id="section-3.4.1-3"><code>VerifyFinalize</code> takes ClientInput values and their corresponding output
digests from <code>Finalize</code> as input, and returns true if the inputs match the outputs.<a href="#section-3.4.1-3" class="pilcrow">¶</a></p>
<p id="section-3.4.1-4">Note that <code>VerifyFinalize</code> and <code>FullEvaluate</code> are not used in the main OPRF
protocol. They are exposed as an API for building higher-level protocols.<a href="#section-3.4.1-4" class="pilcrow">¶</a></p>
<div id="evaluate">
<section id="section-3.4.1.1">
            <h5 id="name-evaluate">
<a href="#section-3.4.1.1" class="section-number selfRef">3.4.1.1. </a><a href="#name-evaluate" class="section-name selfRef">Evaluate</a>
            </h5>
<div class="artwork art-text alignLeft" id="section-3.4.1.1-1">
<pre>
Input:

  PrivateKey skS
  SerializedElement blindedElement

Output:

  SerializedElement evaluatedElement

def Evaluate(skS, blindedElement):
  R = GG.DeserializeElement(blindedElement)
  Z = skS * R
  evaluatedElement = GG.SerializeElement(Z)

  return evaluatedElement
</pre><a href="#section-3.4.1.1-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="fullevaluate">
<section id="section-3.4.1.2">
            <h5 id="name-fullevaluate">
<a href="#section-3.4.1.2" class="section-number selfRef">3.4.1.2. </a><a href="#name-fullevaluate" class="section-name selfRef">FullEvaluate</a>
            </h5>
<div class="artwork art-text alignLeft" id="section-3.4.1.2-1">
<pre>
Input:

  PrivateKey skS
  ClientInput input
  opaque info&lt;1..2^16-1&gt;

Output:

  opaque output[Nh]

def FullEvaluate(skS, input, info):
  P = GG.HashToGroup(input)
  T = skS * P
  issuedElement = GG.SerializeElement(T)

  finalizeDST = "VOPRF06-Finalize-" || self.contextString
  hashInput = I2OSP(len(input), 2) || input ||
              I2OSP(len(issuedElement), 2) || issuedElement ||
              I2OSP(len(info), 2) || info ||
              I2OSP(len(finalizeDST), 2) || finalizeDST

  return Hash(hashInput)
</pre><a href="#section-3.4.1.2-1" class="pilcrow">¶</a>
</div>
<p id="section-3.4.1.2-2">[[RFC editor: please change "VOPRF06" to "RFCXXXX", where XXXX is the final number, here and elsewhere before publication.]]<a href="#section-3.4.1.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="verifyfinalize">
<section id="section-3.4.1.3">
            <h5 id="name-verifyfinalize">
<a href="#section-3.4.1.3" class="section-number selfRef">3.4.1.3. </a><a href="#name-verifyfinalize" class="section-name selfRef">VerifyFinalize</a>
            </h5>
<div class="artwork art-text alignLeft" id="section-3.4.1.3-1">
<pre>
Input:

  PrivateKey skS
  ClientInput input
  opaque info&lt;1..2^16-1&gt;
  opaque output[Nh]

Output:

  boolean valid

def VerifyFinalize(skS, input, info, output):
  T = GG.HashToGroup(input)
  element = GG.SerializeElement(T)
  issuedElement = Evaluate(skS, [element])
  E = GG.SerializeElement(issuedElement)

  finalizeDST = "VOPRF06-Finalize-" || self.contextString
  hashInput = I2OSP(len(input), 2) || input ||
              I2OSP(len(E), 2) || E ||
              I2OSP(len(info), 2) || info ||
              I2OSP(len(finalizeDST), 2) || finalizeDST

  digest = Hash(hashInput)

  return CT_EQUAL(digest, output)
</pre><a href="#section-3.4.1.3-1" class="pilcrow">¶</a>
</div>
<p id="section-3.4.1.3-2">[[RFC editor: please change "VOPRF06" to "RFCXXXX", where XXXX is the final number, here and elsewhere before publication.]]<a href="#section-3.4.1.3-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="verifiableservercontext">
<section id="section-3.4.2">
          <h4 id="name-verifiableservercontext">
<a href="#section-3.4.2" class="section-number selfRef">3.4.2. </a><a href="#name-verifiableservercontext" class="section-name selfRef">VerifiableServerContext</a>
          </h4>
<p id="section-3.4.2-1">The VerifiableServerContext extends the base ServerContext with an
augmented <code>Evaluate()</code> function. This function produces a proof that
<code>skS</code> was used in computing the result. It makes use of the helper
functions <code>GenerateProof</code> and <code>ComputeComposites</code>, described below.<a href="#section-3.4.2-1" class="pilcrow">¶</a></p>
<div id="evaluate-1">
<section id="section-3.4.2.1">
            <h5 id="name-evaluate-2">
<a href="#section-3.4.2.1" class="section-number selfRef">3.4.2.1. </a><a href="#name-evaluate-2" class="section-name selfRef">Evaluate</a>
            </h5>
<div class="artwork art-text alignLeft" id="section-3.4.2.1-1">
<pre>
Input:

  PrivateKey skS
  PublicKey pkS
  SerializedElement blindedElement

Output:

  SerializedElement evaluatedElement
  Proof proof

def Evaluate(skS, pkS, blindedElement):
  R = GG.DeserializeElement(blindedElement)
  Z = skS * R
  evaluatedElement = GG.SerializeElement(Z)

  proof = GenerateProof(skS, pkS, blindedElement, evaluatedElement)

  return evaluatedElement, proof
</pre><a href="#section-3.4.2.1-1" class="pilcrow">¶</a>
</div>
<p id="section-3.4.2.1-2">The helper functions <code>GenerateProof</code> and <code>ComputeComposites</code> are defined
below.<a href="#section-3.4.2.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="generateproof">
<section id="section-3.4.2.2">
            <h5 id="name-generateproof">
<a href="#section-3.4.2.2" class="section-number selfRef">3.4.2.2. </a><a href="#name-generateproof" class="section-name selfRef">GenerateProof</a>
            </h5>
<div class="artwork art-text alignLeft" id="section-3.4.2.2-1">
<pre>
Input:

  PrivateKey skS
  PublicKey pkS
  SerializedElement blindedElement
  SerializedElement evaluatedElement

Output:

  Proof proof

def GenerateProof(skS, pkS, blindedElement, evaluatedElement)
  blindedElementList = [blindedElement]
  evaluatedElementList = [evaluatedElement]

  a = ComputeCompositesFast(skS, pkS, blindedElementList, evaluatedElementList)

  M = GG.DeserializeElement(a[0])
  r = GG.RandomScalar()
  a2 = GG.SerializeElement(ScalarBaseMult(r))
  a3 = GG.SerializeElement(r * M)

  pkSm = GG.SerializeElement(pkS)
  challengeDST = "VOPRF06-Challenge-" || self.contextString
  h2Input = I2OSP(len(pkSm), 2) || pkSm ||
            I2OSP(len(a[0]), 2) || a[0] ||
            I2OSP(len(a[1]), 2) || a[1] ||
            I2OSP(len(a2), 2) || a2 ||
            I2OSP(len(a3), 2) || a3 ||
            I2OSP(len(challengeDST), 2) || challengeDST

  c = GG.HashToScalar(h2Input)
  s = (r - c * skS) mod p
  proof = [GG.SerializeScalar(c), GG.SerializeScalar(s)]

  return proof
</pre><a href="#section-3.4.2.2-1" class="pilcrow">¶</a>
</div>
<div id="batching-inputs">
<section id="section-3.4.2.2.1">
              <h6 id="name-batching-inputs">
<a href="#section-3.4.2.2.1" class="section-number selfRef">3.4.2.2.1. </a><a href="#name-batching-inputs" class="section-name selfRef">Batching inputs</a>
              </h6>
<p id="section-3.4.2.2.1-1">Unlike other functions, <code>ComputeComposites</code> takes lists of inputs,
rather than a single input. Applications can take advantage of this
functionality by invoking <code>GenerateProof</code> on batches of inputs to
produce a combined, constant-size proof. (In the pseudocode above,
the single inputs <code>blindedElement</code> and <code>evaluatedElement</code> are passed as
one-item lists to <code>ComputeComposites</code>.)<a href="#section-3.4.2.2.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="fresh-randomness">
<section id="section-3.4.2.2.2">
              <h6 id="name-fresh-randomness">
<a href="#section-3.4.2.2.2" class="section-number selfRef">3.4.2.2.2. </a><a href="#name-fresh-randomness" class="section-name selfRef">Fresh randomness</a>
              </h6>
<p id="section-3.4.2.2.2-1">We note here that it is essential that a different <code>r</code> value is used for
every invocation. If this is not done, then this may leak <code>skS</code> as is
possible in Schnorr or (EC)DSA scenarios where fresh randomness is not
used.<a href="#section-3.4.2.2.2-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="computecomposites">
<section id="section-3.4.2.3">
            <h5 id="name-computecomposites">
<a href="#section-3.4.2.3" class="section-number selfRef">3.4.2.3. </a><a href="#name-computecomposites" class="section-name selfRef">ComputeComposites</a>
            </h5>
<p id="section-3.4.2.3-1">The definition of <code>ComputeComposites</code> is given below. This function is
used both on generation and verification of the proof.<a href="#section-3.4.2.3-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-3.4.2.3-2">
<pre>
Input:

  PublicKey pkS
  SerializedElement blindedElements[m]
  SerializedElement evaluatedElements[m]

Output:

  SerializedElement composites[2]

def ComputeComposites(pkS, blindedElements, evaluatedElements):
  pkSm = GG.SerializeElement(pkS)
  seedDST = "VOPRF06-Seed-" || self.contextString
  compositeDST = "VOPRF06-Composite-" || self.contextString
  h1Input = I2OSP(len(pkSm), 2) || pkSm ||
            I2OSP(len(seedDST), 2) || seedDST

  seed = Hash(h1Input)
  M = GG.Identity()
  Z = GG.Identity()
  for i = 0 to m-1:
    h2Input = I2OSP(len(seed), 2) || seed || I2OSP(i, 2) ||
              I2OSP(len(blindedElements[i]), 2) || blindedElements[i] ||
              I2OSP(len(evaluatedElements[i]), 2) || evaluatedElements[i] ||
              I2OSP(len(compositeDST), 2) || compositeDST
    di = GG.HashToScalar(h2Input)
    Mi = GG.DeserializeElement(blindedElements[i])
    M = di * Mi + M
    Zi = GG.DeserializeElement(evaluatedElements[i])
    Z = di * Zi + Z

 return [GG.SerializeElement(M), GG.SerializeElement(Z)]
</pre><a href="#section-3.4.2.3-2" class="pilcrow">¶</a>
</div>
<p id="section-3.4.2.3-3">If the private key is known, as is the case for the server, this function
can be optimized as shown in <code>ComputeCompositesFast</code> below.<a href="#section-3.4.2.3-3" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-3.4.2.3-4">
<pre>
Input:

  PrivateKey skS
  PublicKey pkS
  SerializedElement blindedElements[m]
  SerializedElement evaluatedElements[m]

Output:

  SerializedElement composites[2]

def ComputeCompositesFast(skS, pkS, blindedElements, evaluatedElements):
  pkSm = GG.SerializeElement(pkS)
  seedDST = "VOPRF06-Seed-" || self.contextString
  compositeDST = "VOPRF06-Composite-" || self.contextString
  h1Input = I2OSP(len(pkSm), 2) || pkSm ||
            I2OSP(len(seedDST), 2) || seedDST

  seed = Hash(h1Input)
  M = GG.Identity()
  for i = 0 to m-1:
    h2Input = I2OSP(len(seed), 2) || seed || I2OSP(i, 2) ||
              I2OSP(len(blindedElements[i]), 2) || blindedElements[i] ||
              I2OSP(len(evaluatedElements[i]), 2) || evaluatedElements[i] ||
              I2OSP(len(compositeDST), 2) || compositeDST
    di = GG.HashToScalar(h2Input)
    Mi = GG.DeserializeElement(blindedElements[i])
    M = di * Mi + M

  Z = skS * M

 return [GG.SerializeElement(M), GG.SerializeElement(Z)]
</pre><a href="#section-3.4.2.3-4" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="client-context">
<section id="section-3.4.3">
          <h4 id="name-client-context">
<a href="#section-3.4.3" class="section-number selfRef">3.4.3. </a><a href="#name-client-context" class="section-name selfRef">Client Context</a>
          </h4>
<p id="section-3.4.3-1">The ClientContext encapsulates the context string constructed during
setup. It has three functions, <code>Blind()</code>, <code>Unblind()</code>, and <code>Finalize()</code>,
as described below.<a href="#section-3.4.3-1" class="pilcrow">¶</a></p>
<div id="blind">
<section id="section-3.4.3.1">
            <h5 id="name-blind">
<a href="#section-3.4.3.1" class="section-number selfRef">3.4.3.1. </a><a href="#name-blind" class="section-name selfRef">Blind</a>
            </h5>
<p id="section-3.4.3.1-1">We note here that the blinding mechanism that we use can be modified
slightly with the opportunity for making performance gains in some
scenarios. We detail these modifications in <a href="#blinding" class="xref">Section 6</a>.<a href="#section-3.4.3.1-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-3.4.3.1-2">
<pre>
Input:

  ClientInput input

Output:

  Scalar blind
  SerializedElement blindedElement

def Blind(input):
  blind = GG.RandomScalar()
  P = GG.HashToGroup(input)
  blindedElement = GG.SerializeElement(blind * P)

  return blind, blindedElement
</pre><a href="#section-3.4.3.1-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="unblind">
<section id="section-3.4.3.2">
            <h5 id="name-unblind">
<a href="#section-3.4.3.2" class="section-number selfRef">3.4.3.2. </a><a href="#name-unblind" class="section-name selfRef">Unblind</a>
            </h5>
<p id="section-3.4.3.2-1">In this mode, <code>Unblind</code> takes only two inputs. The additional inputs indicated
in <a href="#protocol-overview" class="xref">Section 3.1</a> are only omitted as they are ignored. These additional
inputs are only useful for the verifiable mode, described in <a href="#verifiable-unblind" class="xref">Section 3.4.4.2</a>.<a href="#section-3.4.3.2-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-3.4.3.2-2">
<pre>
Input:

  Scalar blind
  SerializedElement evaluatedElement

Output:

  SerializedElement unblindedElement

def Unblind(blind, evaluatedElement, ...):
  Z = GG.DeserializeElement(evaluatedElement)
  N = (blind^(-1)) * Z
  unblindedElement = GG.SerializeElement(N)

  return unblindedElement
</pre><a href="#section-3.4.3.2-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="finalize">
<section id="section-3.4.3.3">
            <h5 id="name-finalize">
<a href="#section-3.4.3.3" class="section-number selfRef">3.4.3.3. </a><a href="#name-finalize" class="section-name selfRef">Finalize</a>
            </h5>
<div class="artwork art-text alignLeft" id="section-3.4.3.3-1">
<pre>
Input:

  ClientInput input
  SerializedElement unblindedElement
  opaque info&lt;1..2^16-1&gt;

Output:

  opaque output[Nh]

def Finalize(input, unblindedElement, info):
  finalizeDST = "VOPRF06-Finalize-" || self.contextString
  hashInput = I2OSP(len(input), 2) || input ||
              I2OSP(len(unblindedElement), 2) || unblindedElement ||
              I2OSP(len(info), 2) || info ||
              I2OSP(len(finalizeDST), 2) || finalizeDST
  return Hash(hashInput)
</pre><a href="#section-3.4.3.3-1" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="verifiable-client">
<section id="section-3.4.4">
          <h4 id="name-verifiableclientcontext">
<a href="#section-3.4.4" class="section-number selfRef">3.4.4. </a><a href="#name-verifiableclientcontext" class="section-name selfRef">VerifiableClientContext</a>
          </h4>
<p id="section-3.4.4-1">The VerifiableClientContext extends the base ClientContext with the
desired server public key <code>pkS</code> with an augmented <code>Unblind()</code> function.
This function verifies an evaluation proof using <code>pkS</code>. It makes use of
the helper function <code>ComputeComposites</code> described above. It has one
helper function, <code>VerifyProof()</code>, defined below.<a href="#section-3.4.4-1" class="pilcrow">¶</a></p>
<div id="verifyproof">
<section id="section-3.4.4.1">
            <h5 id="name-verifyproof">
<a href="#section-3.4.4.1" class="section-number selfRef">3.4.4.1. </a><a href="#name-verifyproof" class="section-name selfRef">VerifyProof</a>
            </h5>
<p id="section-3.4.4.1-1">This algorithm outputs a boolean <code>verified</code> which indicates whether the
proof inside of the evaluation verifies correctly, or not.<a href="#section-3.4.4.1-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-3.4.4.1-2">
<pre>
Input:

  PublicKey pkS
  SerializedElement blindedElement
  SerializedElement evaluatedElement
  Proof proof

Output:

  boolean verified

def VerifyProof(pkS, blindedElement, evaluatedElement, proof):
  blindedElementList = [blindedElement]
  evaluatedElementList = [evaluatedElement]

  a = ComputeComposites(pkS, blindedElementList, evaluatedElementList)
  c = GG.DeserializeScalar(proof[0])
  s = GG.DeserializeScalar(proof[1])

  M = GG.DeserializeElement(a[0])
  Z = GG.DeserializeElement(a[1])
  A' = (ScalarBaseMult(s) + c * pkS)
  B' = (s * M + c * Z)
  a2 = GG.SerializeElement(A')
  a3 = GG.SerializeElement(B')

  challengeDST = "VOPRF06-Challenge-" || self.contextString
  h2Input = I2OSP(len(pkS), 2) || pkS ||
            I2OSP(len(a[0]), 2) || a[0] ||
            I2OSP(len(a[1]), 2) || a[1] ||
            I2OSP(len(a2), 2) || a2 ||
            I2OSP(len(a3), 2) || a3 ||
            I2OSP(len(challengeDST), 2) || challengeDST

  expected_c  = GG.HashToScalar(h2Input)

  return CT_EQUAL(expected_c, c)
</pre><a href="#section-3.4.4.1-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="verifiable-unblind">
<section id="section-3.4.4.2">
            <h5 id="name-unblind-2">
<a href="#section-3.4.4.2" class="section-number selfRef">3.4.4.2. </a><a href="#name-unblind-2" class="section-name selfRef">Unblind</a>
            </h5>
<div class="artwork art-text alignLeft" id="section-3.4.4.2-1">
<pre>
Input:

  Scalar blind
  SerializedElement evaluatedElement
  SerializedElement blindedElement
  PublicKey pkS
  Scalar proof

Output:

  SerializedElement unblindedElement

def Unblind(blind, evaluatedElement, blindedElement, pkS, proof):
  if VerifyProof(pkS, blindedElement, evaluatedElement, proof) == false:
    ABORT()

  Z = GG.DeserializeElement(evaluatedElement)
  N = (blind^(-1)) * Z
  unblindedElement = GG.SerializeElement(N)

  return unblindedElement
</pre><a href="#section-3.4.4.2-1" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="ciphersuites">
<section id="section-4">
      <h2 id="name-ciphersuites">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-ciphersuites" class="section-name selfRef">Ciphersuites</a>
      </h2>
<p id="section-4-1">A ciphersuite (also referred to as 'suite' in this document) for the protocol
wraps the functionality required for the protocol to take place. This
ciphersuite should be available to both the client and server, and agreement
on the specific instantiation is assumed throughout. A ciphersuite contains
instantiations of the following functionalities:<a href="#section-4-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4-2.1">
          <code>GG</code>: A prime-order group exposing the API detailed in <a href="#pog" class="xref">Section 2.1</a>, with base
point defined in the corresponding reference for each group. Each group also
specifies HashToGroup, HashToScalar, and serialization functionalities. For
HashToGroup, the domain separation tag (DST) is constructed in accordance
with the recommendations in <span>[<a href="#I-D.irtf-cfrg-hash-to-curve" class="xref">I-D.irtf-cfrg-hash-to-curve</a>]</span>, Section 3.1.<a href="#section-4-2.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-4-2.2">
          <code>Hash</code>: A cryptographic hash function that is indifferentiable from a
Random Oracle, whose output length is Nh bytes long.<a href="#section-4-2.2" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-4-3">This section specifies ciphersuites with supported groups and hash functions.<a href="#section-4-3" class="pilcrow">¶</a></p>
<p id="section-4-4">Applications should take caution in using ciphersuites targeting P-256
and ristretto255. See <a href="#cryptanalysis" class="xref">Section 5.2</a> for related discussion.<a href="#section-4-4" class="pilcrow">¶</a></p>
<div id="oprfristretto255-sha-512">
<section id="section-4.1">
        <h3 id="name-oprfristretto255-sha-512">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-oprfristretto255-sha-512" class="section-name selfRef">OPRF(ristretto255, SHA-512)</a>
        </h3>
<ul class="normal">
<li class="normal" id="section-4.1-1.1">
            <p id="section-4.1-1.1.1">Group: ristretto255 <span>[<a href="#RISTRETTO" class="xref">RISTRETTO</a>]</span><a href="#section-4.1-1.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.1-1.1.2.1">HashToGroup(): Use hash_to_ristretto255
<span>[<a href="#I-D.irtf-cfrg-hash-to-curve" class="xref">I-D.irtf-cfrg-hash-to-curve</a>]</span> with DST =
"VOPRF06-HashToGroup-" || contextString, where contextString is that which is
computed in the Setup functions, and <code>expand_message</code> = <code>expand_message_xmd</code>
using SHA-512.<a href="#section-4.1-1.1.2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-4.1-1.1.2.2">HashToScalar(): Use hash_to_field from <span>[<a href="#I-D.irtf-cfrg-hash-to-curve" class="xref">I-D.irtf-cfrg-hash-to-curve</a>]</span>
using Order() as the prime modulus, with L = 48, and expand_message_xmd
with SHA-512.<a href="#section-4.1-1.1.2.2" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-4.1-1.1.2.3">Serialization: Both group elements and scalars are encoded in Ne = Ns = 32
bytes. For group elements, use the 'Encode' and 'Decode' functions from
<span>[<a href="#RISTRETTO" class="xref">RISTRETTO</a>]</span>. For scalars, ensure they are fully reduced modulo p and
in little-endian order.<a href="#section-4.1-1.1.2.3" class="pilcrow">¶</a>
</li>
            </ul>
</li>
          <li class="normal" id="section-4.1-1.2">Hash: SHA-512, and Nh = 64.<a href="#section-4.1-1.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-4.1-1.3">ID: 0x0001<a href="#section-4.1-1.3" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="oprfdecaf448-sha-512">
<section id="section-4.2">
        <h3 id="name-oprfdecaf448-sha-512">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-oprfdecaf448-sha-512" class="section-name selfRef">OPRF(decaf448, SHA-512)</a>
        </h3>
<ul class="normal">
<li class="normal" id="section-4.2-1.1">
            <p id="section-4.2-1.1.1">Group: decaf448 <span>[<a href="#RISTRETTO" class="xref">RISTRETTO</a>]</span><a href="#section-4.2-1.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2-1.1.2.1">HashToGroup(): Use hash_to_decaf448
<span>[<a href="#I-D.irtf-cfrg-hash-to-curve" class="xref">I-D.irtf-cfrg-hash-to-curve</a>]</span> with DST =
"VOPRF06-HashToGroup-" || contextString, where contextString is that which is
computed in the Setup functions, and <code>expand_message</code> = <code>expand_message_xmd</code>
using SHA-512.<a href="#section-4.2-1.1.2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-4.2-1.1.2.2">HashToScalar(): Use hash_to_field from <span>[<a href="#I-D.irtf-cfrg-hash-to-curve" class="xref">I-D.irtf-cfrg-hash-to-curve</a>]</span>
using Order() as the prime modulus, with L = 84, and <code>expand_message_xmd</code>
with SHA-512.<a href="#section-4.2-1.1.2.2" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-4.2-1.1.2.3">Serialization: Both group elements and scalars are encoded in Ne = Ns = 56
bytes. For group elements, use the 'Encode' and 'Decode' functions from
<span>[<a href="#RISTRETTO" class="xref">RISTRETTO</a>]</span>. For scalars, ensure they are fully reduced modulo p and
in little-endian order.<a href="#section-4.2-1.1.2.3" class="pilcrow">¶</a>
</li>
            </ul>
</li>
          <li class="normal" id="section-4.2-1.2">Hash: SHA-512, and Nh = 64.<a href="#section-4.2-1.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-4.2-1.3">ID: 0x0002<a href="#section-4.2-1.3" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="oprfp-256-sha-256">
<section id="section-4.3">
        <h3 id="name-oprfp-256-sha-256">
<a href="#section-4.3" class="section-number selfRef">4.3. </a><a href="#name-oprfp-256-sha-256" class="section-name selfRef">OPRF(P-256, SHA-256)</a>
        </h3>
<ul class="normal">
<li class="normal" id="section-4.3-1.1">
            <p id="section-4.3-1.1.1">Group: P-256 (secp256r1) <span>[<a href="#x9.62" class="xref">x9.62</a>]</span><a href="#section-4.3-1.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.3-1.1.2.1">HashToGroup(): Use hash_to_curve with suite P256_XMD:SHA-256_SSWU_RO_
<span>[<a href="#I-D.irtf-cfrg-hash-to-curve" class="xref">I-D.irtf-cfrg-hash-to-curve</a>]</span> and DST =
"VOPRF06-HashToGroup-" || contextString, where contextString is that which is
computed in the Setup functions.<a href="#section-4.3-1.1.2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-4.3-1.1.2.2">HashToScalar(): Use hash_to_field from <span>[<a href="#I-D.irtf-cfrg-hash-to-curve" class="xref">I-D.irtf-cfrg-hash-to-curve</a>]</span>
using Order() as the prime modulus, with L = 48, and <code>expand_message_xmd</code>
with SHA-256.<a href="#section-4.3-1.1.2.2" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-4.3-1.1.2.3">Serialization: Elements are serialized as Ne = 33 byte strings using
compressed point encoding for the curve <span>[<a href="#SEC1" class="xref">SEC1</a>]</span>. Scalars are serialized as
Ns = 32 byte strings by fully reducing the value modulo p and in big-endian
order.<a href="#section-4.3-1.1.2.3" class="pilcrow">¶</a>
</li>
            </ul>
</li>
          <li class="normal" id="section-4.3-1.2">Hash: SHA-256, and Nh = 32.<a href="#section-4.3-1.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-4.3-1.3">ID: 0x0003<a href="#section-4.3-1.3" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="oprfp-384-sha-512">
<section id="section-4.4">
        <h3 id="name-oprfp-384-sha-512">
<a href="#section-4.4" class="section-number selfRef">4.4. </a><a href="#name-oprfp-384-sha-512" class="section-name selfRef">OPRF(P-384, SHA-512)</a>
        </h3>
<ul class="normal">
<li class="normal" id="section-4.4-1.1">
            <p id="section-4.4-1.1.1">Group: P-384 (secp384r1) <span>[<a href="#x9.62" class="xref">x9.62</a>]</span><a href="#section-4.4-1.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.4-1.1.2.1">HashToGroup(): Use hash_to_curve with suite P384_XMD:SHA-512_SSWU_RO_
<span>[<a href="#I-D.irtf-cfrg-hash-to-curve" class="xref">I-D.irtf-cfrg-hash-to-curve</a>]</span> and DST =
"VOPRF06-HashToGroup-" || contextString, where contextString is that which is
computed in the Setup functions.<a href="#section-4.4-1.1.2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-4.4-1.1.2.2">HashToScalar(): Use hash_to_field from <span>[<a href="#I-D.irtf-cfrg-hash-to-curve" class="xref">I-D.irtf-cfrg-hash-to-curve</a>]</span>
using Order() as the prime modulus, with L = 72, and <code>expand_message_xmd</code>
with SHA-512.<a href="#section-4.4-1.1.2.2" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-4.4-1.1.2.3">Serialization: Elements are serialized as Ne = 49 byte strings using
compressed point encoding for the curve <span>[<a href="#SEC1" class="xref">SEC1</a>]</span>. Scalars are serialized as
Ns = 48 byte strings by fully reducing the value modulo p and in big-endian
order.<a href="#section-4.4-1.1.2.3" class="pilcrow">¶</a>
</li>
            </ul>
</li>
          <li class="normal" id="section-4.4-1.2">Hash: SHA-512, and Nh = 64.<a href="#section-4.4-1.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-4.4-1.3">ID: 0x0004<a href="#section-4.4-1.3" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="oprfp-521-sha-512">
<section id="section-4.5">
        <h3 id="name-oprfp-521-sha-512">
<a href="#section-4.5" class="section-number selfRef">4.5. </a><a href="#name-oprfp-521-sha-512" class="section-name selfRef">OPRF(P-521, SHA-512)</a>
        </h3>
<ul class="normal">
<li class="normal" id="section-4.5-1.1">
            <p id="section-4.5-1.1.1">Group: P-521 (secp521r1) <span>[<a href="#x9.62" class="xref">x9.62</a>]</span><a href="#section-4.5-1.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.5-1.1.2.1">HashToGroup(): Use hash_to_curve with suite P521_XMD:SHA-512_SSWU_RO_
<span>[<a href="#I-D.irtf-cfrg-hash-to-curve" class="xref">I-D.irtf-cfrg-hash-to-curve</a>]</span> and DST =
"VOPRF06-HashToGroup-" || contextString, where contextString is that which is
computed in the Setup functions.<a href="#section-4.5-1.1.2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-4.5-1.1.2.2">HashToScalar(): Use hash_to_field from <span>[<a href="#I-D.irtf-cfrg-hash-to-curve" class="xref">I-D.irtf-cfrg-hash-to-curve</a>]</span>
using Order() as the prime modulus, with L = 98, and <code>expand_message_xmd</code>
with SHA-512.<a href="#section-4.5-1.1.2.2" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-4.5-1.1.2.3">Serialization: Elements are serialized as Ne = 67 byte strings using
compressed point encoding for the curve <span>[<a href="#SEC1" class="xref">SEC1</a>]</span>. Scalars are serialized as
Ns = 66 byte strings by fully reducing the value modulo p and in big-endian
order.<a href="#section-4.5-1.1.2.3" class="pilcrow">¶</a>
</li>
            </ul>
</li>
          <li class="normal" id="section-4.5-1.2">Hash: SHA-512, and Nh = 64.<a href="#section-4.5-1.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-4.5-1.3">ID: 0x0005<a href="#section-4.5-1.3" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="sec">
<section id="section-5">
      <h2 id="name-security-considerations">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-5-1">This section discusses the cryptographic security of our protocol, along
with some suggestions and trade-offs that arise from the implementation
of an OPRF.<a href="#section-5-1" class="pilcrow">¶</a></p>
<div id="properties">
<section id="section-5.1">
        <h3 id="name-security-properties">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-security-properties" class="section-name selfRef">Security properties</a>
        </h3>
<p id="section-5.1-1">The security properties of an OPRF protocol with functionality y = F(k,
x) include those of a standard PRF. Specifically:<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.1-2.1">Pseudorandomness: F is pseudorandom if the output y = F(k,x) on any
input x is indistinguishable from uniformly sampling any element in
F's range, for a random sampling of k.<a href="#section-5.1-2.1" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-5.1-3">In other words, consider an adversary that picks inputs x from the
domain of F and evaluates F on (k,x) (without knowledge of randomly
sampled k). Then the output distribution F(k,x) is indistinguishable
from the output distribution of a randomly chosen function with the same
domain and range.<a href="#section-5.1-3" class="pilcrow">¶</a></p>
<p id="section-5.1-4">A consequence of showing that a function is pseudorandom, is that it is
necessarily non-malleable (i.e. we cannot compute a new evaluation of F
from an existing evaluation). A genuinely random function will be
non-malleable with high probability, and so a pseudorandom function must
be non-malleable to maintain indistinguishability.<a href="#section-5.1-4" class="pilcrow">¶</a></p>
<p id="section-5.1-5">An OPRF protocol must also satisfy the following property:<a href="#section-5.1-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.1-6.1">Oblivious: The server must learn nothing about the client's input or
the output of the function. In addition, the client must learn nothing
about the server's private key.<a href="#section-5.1-6.1" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-5.1-7">Essentially, obliviousness tells us that, even if the server learns the
client's input x at some point in the future, then the server will not
be able to link any particular OPRF evaluation to x. This property is
also known as unlinkability <span>[<a href="#DGSTV18" class="xref">DGSTV18</a>]</span>.<a href="#section-5.1-7" class="pilcrow">¶</a></p>
<p id="section-5.1-8">Optionally, for any protocol that satisfies the above properties, there
is an additional security property:<a href="#section-5.1-8" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.1-9.1">Verifiable: The client must only complete execution of the protocol if
it can successfully assert that the OPRF output it computes is
correct. This is taken with respect to the OPRF key held by the
server.<a href="#section-5.1-9.1" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-5.1-10">Any OPRF that satisfies the 'verifiable' security property is known as a
verifiable OPRF, or VOPRF for short. In practice, the notion of
verifiability requires that the server commits to the key before the
actual protocol execution takes place. Then the client verifies that the
server has used the key in the protocol using this commitment. In the
following, we may also refer to this commitment as a public key.<a href="#section-5.1-10" class="pilcrow">¶</a></p>
</section>
</div>
<div id="cryptanalysis">
<section id="section-5.2">
        <h3 id="name-cryptographic-security">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-cryptographic-security" class="section-name selfRef">Cryptographic security</a>
        </h3>
<p id="section-5.2-1">Below, we discuss the cryptographic security of the (V)OPRF protocol
from <a href="#protocol" class="xref">Section 3</a>, relative to the necessary cryptographic assumptions
that need to be made.<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<div id="assumptions">
<section id="section-5.2.1">
          <h4 id="name-computational-hardness-assu">
<a href="#section-5.2.1" class="section-number selfRef">5.2.1. </a><a href="#name-computational-hardness-assu" class="section-name selfRef">Computational hardness assumptions</a>
          </h4>
<p id="section-5.2.1-1">Each assumption states that the problems specified below are
computationally difficult to solve in relation to a particular choice of
security parameter <code>sp</code>.<a href="#section-5.2.1-1" class="pilcrow">¶</a></p>
<p id="section-5.2.1-2">Let GG = GG(sp) be a group with prime-order p, and let GF(p) be a finite
field of order p.<a href="#section-5.2.1-2" class="pilcrow">¶</a></p>
<div id="dl">
<section id="section-5.2.1.1">
            <h5 id="name-discrete-log-dl-problem">
<a href="#section-5.2.1.1" class="section-number selfRef">5.2.1.1. </a><a href="#name-discrete-log-dl-problem" class="section-name selfRef">Discrete-log (DL) problem</a>
            </h5>
<p id="section-5.2.1.1-1">Given G, a generator of GG, and H = hG for some h in GF(p); output h.<a href="#section-5.2.1.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ddh">
<section id="section-5.2.1.2">
            <h5 id="name-decisional-diffie-hellman-d">
<a href="#section-5.2.1.2" class="section-number selfRef">5.2.1.2. </a><a href="#name-decisional-diffie-hellman-d" class="section-name selfRef">Decisional Diffie-Hellman (DDH) problem</a>
            </h5>
<p id="section-5.2.1.2-1">Sample uniformly at random d in {0,1}. Given (G, aG, bG, C), where<a href="#section-5.2.1.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.2.1.2-2.1">G is a generator of GG;<a href="#section-5.2.1.2-2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-5.2.1.2-2.2">a,b are elements of GF(p);<a href="#section-5.2.1.2-2.2" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-5.2.1.2-2.3">if d == 0: C = abG; else: C is sampled uniformly at random from GG.<a href="#section-5.2.1.2-2.3" class="pilcrow">¶</a>
</li>
            </ul>
<p id="section-5.2.1.2-3">Output d' == d.<a href="#section-5.2.1.2-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="protocol-sec">
<section id="section-5.2.2">
          <h4 id="name-protocol-security">
<a href="#section-5.2.2" class="section-number selfRef">5.2.2. </a><a href="#name-protocol-security" class="section-name selfRef">Protocol security</a>
          </h4>
<p id="section-5.2.2-1">Our OPRF construction is based on the VOPRF construction known as
2HashDH-NIZK given by <span>[<a href="#JKK14" class="xref">JKK14</a>]</span>; essentially without providing
zero-knowledge proofs that verify that the output is correct. Our VOPRF
construction is identical to the <span>[<a href="#JKK14" class="xref">JKK14</a>]</span> construction, except that we
can optionally perform multiple VOPRF evaluations in one go, whilst only
constructing one NIZK proof object. This is enabled using an established
batching technique.<a href="#section-5.2.2-1" class="pilcrow">¶</a></p>
<p id="section-5.2.2-2">Consequently, the cryptographic security of our construction is based on
the assumption that the One-More Gap DH is computationally difficult to
solve.<a href="#section-5.2.2-2" class="pilcrow">¶</a></p>
<p id="section-5.2.2-3">The (N,Q)-One-More Gap DH (OMDH) problem asks the following.<a href="#section-5.2.2-3" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-5.2.2-4">
<pre>
    Given:
    - G, k * G, and (G_1, ... , G_N), all elements of GG;
    - oracle access to an OPRF functionality using the key k;
    - oracle access to DDH solvers.

    Find Q+1 pairs of the form below:

    (G_{j_s}, k * G_{j_s})

    where the following conditions hold:
      - s is a number between 1 and Q+1;
      - j_s is a number between 1 and N for each s;
      - Q is the number of allowed queries.
</pre><a href="#section-5.2.2-4" class="pilcrow">¶</a>
</div>
<p id="section-5.2.2-5">The original paper <span>[<a href="#JKK14" class="xref">JKK14</a>]</span> gives a security proof that the
2HashDH-NIZK construction satisfies the security guarantees of a VOPRF
protocol <a href="#properties" class="xref">Section 5.1</a> under the OMDH assumption in the universal
composability (UC) security model.<a href="#section-5.2.2-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="qsdh">
<section id="section-5.2.3">
          <h4 id="name-q-strong-dh-oracle">
<a href="#section-5.2.3" class="section-number selfRef">5.2.3. </a><a href="#name-q-strong-dh-oracle" class="section-name selfRef">Q-strong-DH oracle</a>
          </h4>
<p id="section-5.2.3-1">A side-effect of our OPRF design is that it allows instantiation of a
oracle for constructing Q-strong-DH (Q-sDH) samples. The Q-Strong-DH
problem asks the following.<a href="#section-5.2.3-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-5.2.3-2">
<pre>
    Given G1, G2, h*G2, (h^2)*G2, ..., (h^Q)*G2; for G1 and G2
    generators of GG.

    Output ( (1/(k+c))*G1, c ) where c is an element of GF(p)
</pre><a href="#section-5.2.3-2" class="pilcrow">¶</a>
</div>
<p id="section-5.2.3-3">The assumption that this problem is hard was first introduced in
<span>[<a href="#BB04" class="xref">BB04</a>]</span>. Since then, there have been a number of cryptanalytic studies
that have reduced the security of the assumption below that implied by
the group instantiation (for example, <span>[<a href="#BG04" class="xref">BG04</a>]</span> and <span>[<a href="#Cheon06" class="xref">Cheon06</a>]</span>). In
summary, the attacks reduce the security of the group instantiation by
log_2(Q) bits.<a href="#section-5.2.3-3" class="pilcrow">¶</a></p>
<p id="section-5.2.3-4">As an example, suppose that a group instantiation is used that provides
128 bits of security against discrete log cryptanalysis. Then an
adversary with access to a Q-sDH oracle and makes Q=2^20 queries can
reduce the security of the instantiation by log_2(2^20) = 20 bits.<a href="#section-5.2.3-4" class="pilcrow">¶</a></p>
<p id="section-5.2.3-5">Notice that it is easy to instantiate a Q-sDH oracle using the OPRF
functionality that we provide. A client can just submit sequential
queries of the form (G, k * G, (k^2)G, ..., (k^(Q-1))G), where each
query is the output of the previous interaction. This means that any
client that submits Q queries to the OPRF can use the aforementioned
attacks to reduce the security of the group instantiation by log_2(Q) bits.<a href="#section-5.2.3-5" class="pilcrow">¶</a></p>
<p id="section-5.2.3-6">Recall that from a malicious client's perspective, the adversary wins if
they can distinguish the OPRF interaction from a protocol that computes
the ideal functionality provided by the PRF.<a href="#section-5.2.3-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="implications-for-ciphersuite-choices">
<section id="section-5.2.4">
          <h4 id="name-implications-for-ciphersuit">
<a href="#section-5.2.4" class="section-number selfRef">5.2.4. </a><a href="#name-implications-for-ciphersuit" class="section-name selfRef">Implications for ciphersuite choices</a>
          </h4>
<p id="section-5.2.4-1">The OPRF instantiations that we recommend in this document are informed
by the cryptanalytic discussion above. In particular, choosing elliptic
curves configurations that describe 128-bit group instantiations would
appear to in fact instantiate an OPRF with 128-log_2(Q) bits of
security.<a href="#section-5.2.4-1" class="pilcrow">¶</a></p>
<p id="section-5.2.4-2">In most cases, it would require an informed and persistent attacker to
launch a highly expensive attack to reduce security to anything much
below 100 bits of security. We see this possibility as something that
may result in problems in the future. For applications that cannot
tolerate discrete logarithm security of lower than 128 bits, we
recommend only implementing ciphersuites with IDs: 0x0002, 0x0004, and
0x0005.<a href="#section-5.2.4-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="hashing-to-curve">
<section id="section-5.3">
        <h3 id="name-hashing-to-curve">
<a href="#section-5.3" class="section-number selfRef">5.3. </a><a href="#name-hashing-to-curve" class="section-name selfRef">Hashing to curve</a>
        </h3>
<p id="section-5.3-1">A critical requirement of implementing the prime-order group using
elliptic curves is a method to instantiate the function
<code>GG.HashToGroup</code>, that maps inputs to group elements. In the elliptic
curve setting, this deterministically maps inputs x (as byte arrays) to
uniformly chosen points on the curve.<a href="#section-5.3-1" class="pilcrow">¶</a></p>
<p id="section-5.3-2">In the security proof of the construction Hash is modeled as a random
oracle. This implies that any instantiation of <code>GG.HashToGroup</code> must be
pre-image and collision resistant. In <a href="#ciphersuites" class="xref">Section 4</a> we give
instantiations of this functionality based on the functions described in
<span>[<a href="#I-D.irtf-cfrg-hash-to-curve" class="xref">I-D.irtf-cfrg-hash-to-curve</a>]</span>. Consequently, any OPRF implementation
must adhere to the implementation and security considerations discussed
in <span>[<a href="#I-D.irtf-cfrg-hash-to-curve" class="xref">I-D.irtf-cfrg-hash-to-curve</a>]</span> when instantiating the function.<a href="#section-5.3-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="timing-leaks">
<section id="section-5.4">
        <h3 id="name-timing-leaks">
<a href="#section-5.4" class="section-number selfRef">5.4. </a><a href="#name-timing-leaks" class="section-name selfRef">Timing Leaks</a>
        </h3>
<p id="section-5.4-1">To ensure no information is leaked during protocol execution, all
operations that use secret data MUST run in constant time. Operations that
SHOULD run in constant time include all prime-order group operations and
proof-specific operations (<code>GenerateProof()</code> and <code>VerifyProof()</code>).<a href="#section-5.4-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="key-rotation">
<section id="section-5.5">
        <h3 id="name-key-rotation">
<a href="#section-5.5" class="section-number selfRef">5.5. </a><a href="#name-key-rotation" class="section-name selfRef">Key rotation</a>
        </h3>
<p id="section-5.5-1">Since the server's key is critical to security, the longer it is exposed
by performing (V)OPRF operations on client inputs, the longer it is
possible that the key can be compromised. For example, if the key is kept
in circulation for a long period of time, then it also allows the
clients to make enough queries to launch more powerful variants of the
Q-sDH attacks from <a href="#qsdh" class="xref">Section 5.2.3</a>.<a href="#section-5.5-1" class="pilcrow">¶</a></p>
<p id="section-5.5-2">To combat attacks of this nature, regular key rotation should be
employed on the server-side. A suitable key-cycle for a key used to
compute (V)OPRF evaluations would be between one week and six months.<a href="#section-5.5-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="blinding">
<section id="section-6">
      <h2 id="name-additive-blinding">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-additive-blinding" class="section-name selfRef">Additive blinding</a>
      </h2>
<p id="section-6-1">Let <code>H</code> refer to the function <code>GG.HashToGroup</code>, in <a href="#pog" class="xref">Section 2.1</a> we assume
that the client-side blinding is carried out directly on the output of
<code>H(x)</code>, i.e. computing <code>r * H(x)</code> for some <code>r</code> sampled uniformly at random
from <code>GF(p)</code>. In the <span>[<a href="#I-D.irtf-cfrg-opaque" class="xref">I-D.irtf-cfrg-opaque</a>]</span> document, it is noted that it
may be more efficient to use additive blinding (rather than multiplicative)
if the client can preprocess some values. For example, a valid way of
computing additive blinding would be to instead compute <code>H(x) + (r * G)</code>,
where <code>G</code> is the fixed generator for the group <code>GG</code>.<a href="#section-6-1" class="pilcrow">¶</a></p>
<p id="section-6-2">The advantage of additive blinding is that it allows the client to
pre-process tables of blinded scalar multiplications for <code>G</code>. This may
give it a computational efficiency advantage (due to the fact that a
fixed-base multiplication can be calculated faster than a variable-base
multiplication). Pre-processing also reduces the amount of computation
that needs to be done in the online exchange. Choosing one of these
values <code>r * G</code> (where <code>r</code> is the scalar value that is used), then
computing <code>H(x) + (r * G)</code> is more efficient than computing <code>r * H(x)</code>.
Therefore, it may be advantageous to define the OPRF and VOPRF protocols
using additive (rather than multiplicative) blinding. In fact,
the only algorithms that need to change are <code>Blind</code> and <code>Unblind</code> (and
similarly for the VOPRF variants).<a href="#section-6-2" class="pilcrow">¶</a></p>
<p id="section-6-3">We define the variants of the algorithms in <a href="#api" class="xref">Section 3.4</a> for performing
additive blinding below, called <code>AdditiveBlind</code> and <code>AdditiveUnblind</code>,
along with a new algorithm <code>Preprocess</code>. The <code>Preprocess</code> algorithm can
take place offline and before the rest of the OPRF protocol. <code>AdditiveBlind</code>
takes the preprocessed values as inputs. <code>AdditiveUnblind</code> takes the
preprocessed values and evaluated element from the server as inputs.<a href="#section-6-3" class="pilcrow">¶</a></p>
<div id="preprocess">
<section id="section-6.1">
        <h3 id="name-preprocess">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-preprocess" class="section-name selfRef">Preprocess</a>
        </h3>
<div class="artwork art-text alignLeft" id="section-6.1-1">
<pre>
Input:

  PublicKey pkS

Output:

  Element blindedGenerator
  Element blindedPublicKey

def Preprocess(pkS):
  blind = GG.RandomScalar()
  blindedGenerator = ScalarBaseMult(blind)
  blindedPublicKey = blind * pkS

  return blindedGenerator, blindedPublicKey
</pre><a href="#section-6.1-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="additiveblind">
<section id="section-6.2">
        <h3 id="name-additiveblind">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-additiveblind" class="section-name selfRef">AdditiveBlind</a>
        </h3>
<div class="artwork art-text alignLeft" id="section-6.2-1">
<pre>
Input:

  ClientInput input
  Element blindedGenerator

Output:

  SerializedElement blindedElement

def AdditiveBlind(input, blindedGenerator):
  P = GG.HashToGroup(input)
  blindedElement = GG.SerializeElement(P + blindedGenerator) /* P + ScalarBaseMult(r) */

  return blindedElement
</pre><a href="#section-6.2-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="additiveunblind">
<section id="section-6.3">
        <h3 id="name-additiveunblind">
<a href="#section-6.3" class="section-number selfRef">6.3. </a><a href="#name-additiveunblind" class="section-name selfRef">AdditiveUnblind</a>
        </h3>
<div class="artwork art-text alignLeft" id="section-6.3-1">
<pre>
Input:

  Element blindedPublicKey
  SerializedElement evaluatedElement

Output:

 SerializedElement unblindedElement

def AdditiveUnblind(blindedPublicKey, evaluatedElement):
  Z = GG.DeserializeElement(evaluatedElement)
  N := Z - blindedPublicKey

  unblindedElement = GG.SerializeElement(N)

  return unblindedElement
</pre><a href="#section-6.3-1" class="pilcrow">¶</a>
</div>
<p id="section-6.3-2">Let <code>P = GG.HashToGroup(input)</code>. Notice that AdditiveUnblind computes:<a href="#section-6.3-2" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-6.3-3">
<pre>
Z - blindedPublicKey = k * (P + r * G) - r * pkS
                     = k * P + k * (r * G) - r * (k * G)
                     = k * P
</pre><a href="#section-6.3-3" class="pilcrow">¶</a>
</div>
<p id="section-6.3-4">by the commutativity of the scalar field. This is the same
output as in the <code>Unblind</code> algorithm for multiplicative blinding.<a href="#section-6.3-4" class="pilcrow">¶</a></p>
<p id="section-6.3-5">Note that the verifiable variant of <code>AdditiveUnblind</code> works as above but
includes the step to <code>VerifyProof</code>, as specified in <a href="#verifiable-client" class="xref">Section 3.4.4</a>.<a href="#section-6.3-5" class="pilcrow">¶</a></p>
<div id="parameter-commitments">
<section id="section-6.3.1">
          <h4 id="name-parameter-commitments">
<a href="#section-6.3.1" class="section-number selfRef">6.3.1. </a><a href="#name-parameter-commitments" class="section-name selfRef">Parameter Commitments</a>
          </h4>
<p id="section-6.3.1-1">For some applications, it may be desirable for the server to bind tokens to
certain parameters, e.g., protocol versions, ciphersuites, etc. To
accomplish this, the server should use a distinct scalar for each parameter
combination. Upon redemption of a token T from the client, the server can
later verify that T was generated using the scalar associated with the
corresponding parameters.<a href="#section-6.3.1-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="acknowledgements">
<section id="section-7">
      <h2 id="name-acknowledgements">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-acknowledgements" class="section-name selfRef">Acknowledgements</a>
      </h2>
<p id="section-7-1">This document resulted from the work of the Privacy Pass team
<span>[<a href="#PrivacyPass" class="xref">PrivacyPass</a>]</span>. The authors would also like to acknowledge helpful
conversations with Hugo Krawczyk. Eli-Shaoul Khedouri provided
additional review and comments on key consistency. Daniel Bourdrez,
Tatiana Bradley, Sofia Celi, Frank Denis, and Bas Westerbaan also
provided helpful input and contributions to the document.<a href="#section-7-1" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-8">
      <h2 id="name-references">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<section id="section-8.1">
        <h3 id="name-normative-references">
<a href="#section-8.1" class="section-number selfRef">8.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="BB04">[BB04]</dt>
        <dd>
<span class="refTitle">"Short Signatures Without Random Oracles"</span>, <span>&lt;<a href="http://ai.stanford.edu/~xb/eurocrypt04a/bbsigs.pdf">http://ai.stanford.edu/~xb/eurocrypt04a/bbsigs.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="BG04">[BG04]</dt>
        <dd>
<span class="refTitle">"The Static Diffie-Hellman Problem"</span>, <span>&lt;<a href="https://eprint.iacr.org/2004/306">https://eprint.iacr.org/2004/306</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Cheon06">[Cheon06]</dt>
        <dd>
<span class="refTitle">"Security Analysis of the Strong Diffie-Hellman Problem"</span>, <span>&lt;<a href="https://www.iacr.org/archive/eurocrypt2006/40040001/40040001.pdf">https://www.iacr.org/archive/eurocrypt2006/40040001/40040001.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="DGSTV18">[DGSTV18]</dt>
        <dd>
<span class="refTitle">"Privacy Pass, Bypassing Internet Challenges Anonymously"</span>, <span>&lt;<a href="https://www.degruyter.com/view/j/popets.2018.2018.issue-3/popets-2018-0026/popets-2018-0026.xml">https://www.degruyter.com/view/j/popets.2018.2018.issue-3/popets-2018-0026/popets-2018-0026.xml</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.davidson-pp-protocol">[I-D.davidson-pp-protocol]</dt>
        <dd>
<span class="refAuthor">Davidson, A.</span>, <span class="refTitle">"Privacy Pass: The Protocol"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-davidson-pp-protocol-01</span>, <time datetime="2020-07-13" class="refDate">13 July 2020</time>, <span>&lt;<a href="http://www.ietf.org/internet-drafts/draft-davidson-pp-protocol-01.txt">http://www.ietf.org/internet-drafts/draft-davidson-pp-protocol-01.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.irtf-cfrg-hash-to-curve">[I-D.irtf-cfrg-hash-to-curve]</dt>
        <dd>
<span class="refAuthor">Faz-Hernandez, A.</span><span class="refAuthor">, Scott, S.</span><span class="refAuthor">, Sullivan, N.</span><span class="refAuthor">, Wahby, R.</span><span class="refAuthor">, and C. Wood</span>, <span class="refTitle">"Hashing to Elliptic Curves"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-irtf-cfrg-hash-to-curve-10</span>, <time datetime="2020-10-11" class="refDate">11 October 2020</time>, <span>&lt;<a href="http://www.ietf.org/internet-drafts/draft-irtf-cfrg-hash-to-curve-10.txt">http://www.ietf.org/internet-drafts/draft-irtf-cfrg-hash-to-curve-10.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.irtf-cfrg-opaque">[I-D.irtf-cfrg-opaque]</dt>
        <dd>
<span class="refAuthor">Krawczyk, H.</span><span class="refAuthor">, Lewi, K.</span><span class="refAuthor">, and C. Wood</span>, <span class="refTitle">"The OPAQUE Asymmetric PAKE Protocol"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-irtf-cfrg-opaque-01</span>, <time datetime="2020-11-02" class="refDate">2 November 2020</time>, <span>&lt;<a href="http://www.ietf.org/internet-drafts/draft-irtf-cfrg-opaque-01.txt">http://www.ietf.org/internet-drafts/draft-irtf-cfrg-opaque-01.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="JKK14">[JKK14]</dt>
        <dd>
<span class="refTitle">"Round-Optimal Password-Protected Secret Sharing and T-PAKE in the Password-Only model"</span>, <span>&lt;<a href="https://eprint.iacr.org/2014/650">https://eprint.iacr.org/2014/650</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="JKKX16">[JKKX16]</dt>
        <dd>
<span class="refTitle">"Highly-Efficient and Composable Password-Protected Secret Sharing (Or, How to Protect Your Bitcoin Wallet Online)"</span>, <span>&lt;<a href="https://eprint.iacr.org/2016/144">https://eprint.iacr.org/2016/144</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="PrivacyPass">[PrivacyPass]</dt>
        <dd>
<span class="refTitle">"Privacy Pass"</span>, <span>&lt;<a href="https://github.com/privacypass/challenge-bypass-server">https://github.com/privacypass/challenge-bypass-server</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7748">[RFC7748]</dt>
        <dd>
<span class="refAuthor">Langley, A.</span><span class="refAuthor">, Hamburg, M.</span><span class="refAuthor">, and S. Turner</span>, <span class="refTitle">"Elliptic Curves for Security"</span>, <span class="seriesInfo">RFC 7748</span>, <span class="seriesInfo">DOI 10.17487/RFC7748</span>, <time datetime="2016-01" class="refDate">January 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7748">https://www.rfc-editor.org/info/rfc7748</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8017">[RFC8017]</dt>
        <dd>
<span class="refAuthor">Moriarty, K., Ed.</span><span class="refAuthor">, Kaliski, B.</span><span class="refAuthor">, Jonsson, J.</span><span class="refAuthor">, and A. Rusch</span>, <span class="refTitle">"PKCS #1: RSA Cryptography Specifications Version 2.2"</span>, <span class="seriesInfo">RFC 8017</span>, <span class="seriesInfo">DOI 10.17487/RFC8017</span>, <time datetime="2016-11" class="refDate">November 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8017">https://www.rfc-editor.org/info/rfc8017</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RISTRETTO">[RISTRETTO]</dt>
        <dd>
<span class="refAuthor">Valence, H.</span><span class="refAuthor">, Grigg, J.</span><span class="refAuthor">, Tankersley, G.</span><span class="refAuthor">, Valsorda, F.</span><span class="refAuthor">, Lovecruft, I.</span><span class="refAuthor">, and M. Hamburg</span>, <span class="refTitle">"The ristretto255 and decaf448 Groups"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-irtf-cfrg-ristretto255-decaf448-00</span>, <time datetime="2020-10-05" class="refDate">5 October 2020</time>, <span>&lt;<a href="http://www.ietf.org/internet-drafts/draft-irtf-cfrg-ristretto255-decaf448-00.txt">http://www.ietf.org/internet-drafts/draft-irtf-cfrg-ristretto255-decaf448-00.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="SEC1">[SEC1]</dt>
        <dd>
<span class="refAuthor">Standards for Efficient Cryptography Group (SECG), .</span>, <span class="refTitle">"SEC 1: Elliptic Curve Cryptography"</span>, <span>&lt;<a href="https://www.secg.org/sec1-v2.pdff">https://www.secg.org/sec1-v2.pdff</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="SEC2">[SEC2]</dt>
        <dd>
<span class="refAuthor">Standards for Efficient Cryptography Group (SECG), .</span>, <span class="refTitle">"SEC 2: Recommended Elliptic Curve Domain Parameters"</span>, <span>&lt;<a href="http://www.secg.org/sec2-v2.pdf">http://www.secg.org/sec2-v2.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="SJKS17">[SJKS17]</dt>
        <dd>
<span class="refTitle">"SPHINX, A Password Store that Perfectly Hides from Itself"</span>, <span>&lt;<a href="https://eprint.iacr.org/2018/695">https://eprint.iacr.org/2018/695</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="x9.62">[x9.62]</dt>
      <dd>
<span class="refAuthor">ANSI</span>, <span class="refTitle">"Public Key Cryptography for the Financial Services Industry: the Elliptic Curve Digital Signature Algorithm (ECDSA)"</span>, <span class="seriesInfo">ANSI X9.62-1998</span>, <time datetime="1998-09" class="refDate">September 1998</time>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-8.2">
        <h3 id="name-informative-references">
<a href="#section-8.2" class="section-number selfRef">8.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="RFC8446">[RFC8446]</dt>
      <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refTitle">"The Transport Layer Security (TLS) Protocol Version 1.3"</span>, <span class="seriesInfo">RFC 8446</span>, <span class="seriesInfo">DOI 10.17487/RFC8446</span>, <time datetime="2018-08" class="refDate">August 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8446">https://www.rfc-editor.org/info/rfc8446</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="test-vectors">
<section id="section-appendix.a">
      <h2 id="name-test-vectors">
<a href="#section-appendix.a" class="section-number selfRef">Appendix A. </a><a href="#name-test-vectors" class="section-name selfRef">Test Vectors</a>
      </h2>
<p id="section-appendix.a-1">This section includes test vectors for the (V)OPRF protocol specified
in this document. For each ciphersuite specified in <a href="#ciphersuites" class="xref">Section 4</a>,
there is a set of test vectors for the protocol when run in the base
mode and verifiable mode. Each test vector lists the batch size for
the evaluation. Each test vector value is encoded as a hexadecimal
byte string. The label for each test vector value is described below.<a href="#section-appendix.a-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-appendix.a-2.1">"Input": The client input, an opaque byte string.<a href="#section-appendix.a-2.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-appendix.a-2.2">"Blind": The blind value output by <code>Blind()</code>, a serialized <code>Scalar</code>
of <code>Ns</code> bytes long.<a href="#section-appendix.a-2.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-appendix.a-2.3">"BlindedElement": The blinded value output by <code>Blind()</code>, a serialized
<code>Element</code> of <code>Ne</code> bytes long.<a href="#section-appendix.a-2.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-appendix.a-2.4">"EvaluatedElement": The evaluated element output by <code>Evaluate()</code>,
a serialized <code>Element</code> of <code>Ne</code> bytes long.<a href="#section-appendix.a-2.4" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-appendix.a-2.5">"EvaluationProofC": The "c" component of the Evaluation proof (only
listed for verifiable mode test vectors), a serialized <code>Scalar</code> of
<code>Ns</code> bytes long.<a href="#section-appendix.a-2.5" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-appendix.a-2.6">"EvaluationProofS": The "s" component of the Evaluation proof (only
listed for verifiable mode test vectors), a serialized <code>Scalar</code> of
<code>Ns</code> bytes long.<a href="#section-appendix.a-2.6" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-appendix.a-2.7">"UnblindedElement": The unblinded element output by <code>Unblind()</code>,
a serialized <code>Element</code> of <code>Ne</code> bytes long.<a href="#section-appendix.a-2.7" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-appendix.a-2.8">"Info": The client <code>info</code> parameter, an opaque byte string.<a href="#section-appendix.a-2.8" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-appendix.a-2.9">"Output": The OPRF output, a byte string of length <code>Nh</code> bytes.<a href="#section-appendix.a-2.9" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-appendix.a-3">Test vectors with batch size B &gt; 1 have inputs separated by a comma
",". Applicable test vectors will have B different values for the
"Input", "Blind", "BlindedElement", "EvaluationElement",
"UnblindedElement", and "Output" fields.<a href="#section-appendix.a-3" class="pilcrow">¶</a></p>
<p id="section-appendix.a-4">The server key material, <code>pkSm</code> and <code>skSm</code>, are listed under the mode for
each ciphersuite. Both <code>pkSm</code> and <code>skSm</code> are the serialized values of
<code>pkS</code> and <code>skS</code>, respectively, as used in the protocol.<a href="#section-appendix.a-4" class="pilcrow">¶</a></p>
<div id="oprfristretto255-sha-512-1">
<section id="section-a.1">
        <h2 id="name-oprfristretto255-sha-512-2">
<a href="#section-a.1" class="section-number selfRef">A.1. </a><a href="#name-oprfristretto255-sha-512-2" class="section-name selfRef">OPRF(ristretto255, SHA-512)</a>
        </h2>
<div id="base-mode">
<section id="section-a.1.1">
          <h3 id="name-base-mode">
<a href="#section-a.1.1" class="section-number selfRef">A.1.1. </a><a href="#name-base-mode" class="section-name selfRef">Base Mode</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-a.1.1-1">
<pre>
skSm = c604c785ada70d77a5256ae21767de8c3304115237d262134f5e46e512cf8
e03
</pre><a href="#section-a.1.1-1" class="pilcrow">¶</a>
</div>
<div id="test-vector-1-batch-size-1">
<section id="section-a.1.1.1">
            <h4 id="name-test-vector-1-batch-size-1">
<a href="#section-a.1.1.1" class="section-number selfRef">A.1.1.1. </a><a href="#name-test-vector-1-batch-size-1" class="section-name selfRef">Test Vector 1, Batch Size 1</a>
            </h4>
<div class="artwork art-text alignLeft" id="section-a.1.1.1-1">
<pre>
Input = 00
Blind = 5ed895206bfc53316d307b23e46ecc6623afb3086da74189a416012be037
e50b
BlindedElement = 5cccd309ec729aebe398c53e19c0ab09c24a29f01036960bdad
109852e7bdb44
EvaluationElement = 86bd5eeabf29a87cb4a5c7207cb3ade5297e65f9b74c979b
d3551891f4b21515
UnblindedElement = 3c7f2d901c0d4f245503a186086fbdf5d8b4408432b25c516
3e8b5a19c258348
Info = 4f505246207465737420766563746f7273
Output = 0bb570873cc0402ca38f1a2c395301f2a3627616e305f2bc54bb08c3f6e
a9871eb71074e52e36b90778ba7c3e3429ef7170245c9e01647f3827fdef84d3ba93
0
</pre><a href="#section-a.1.1.1-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="test-vector-2-batch-size-1">
<section id="section-a.1.1.2">
            <h4 id="name-test-vector-2-batch-size-1">
<a href="#section-a.1.1.2" class="section-number selfRef">A.1.1.2. </a><a href="#name-test-vector-2-batch-size-1" class="section-name selfRef">Test Vector 2, Batch Size 1</a>
            </h4>
<div class="artwork art-text alignLeft" id="section-a.1.1.2-1">
<pre>
Input = 5a5a5a5a5a5a5a5a5a5a5a5a5a5a5a5a5a
Blind = ed8366feb6b1d05d1f46acb727061e43aadfafe9c10e5a64e7518d63e326
3503
BlindedElement = 227d63ca69e93bd062193c1e97fff3d5ebf628f646009d77c4e
22ba6429be154
EvaluationElement = 063b91a12e7cbb98dfeb75d8a7eeb83aacf9fd6df7e0b419
7466fb77a27fa631
UnblindedElement = 804ec6774764ed50a0bbad0a5f477aa04df7323acab8f98ca
6e468b7790bca4c
Info = 4f505246207465737420766563746f7273
Output = af7cc264dbc96a6b898ba0fa33bfa9e1407bf1dcfbf8772204d470d4458
b8f047806679dbfa251f656b906edf9fa638e268adf979bd0e2380a092047d61f9db
9
</pre><a href="#section-a.1.1.2-1" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="verifiable-mode">
<section id="section-a.1.2">
          <h3 id="name-verifiable-mode">
<a href="#section-a.1.2" class="section-number selfRef">A.1.2. </a><a href="#name-verifiable-mode" class="section-name selfRef">Verifiable Mode</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-a.1.2-1">
<pre>
skSm = 019cbd1d7420292528f8cdd62f339fdabb602f04a95dac9dbcec831b8c681
a09
pkSm = eee7a9c7fec3460c27c160c683d46a4fd18f537c055c3998748b8e4cd8f29
b3e
</pre><a href="#section-a.1.2-1" class="pilcrow">¶</a>
</div>
<div id="test-vector-1-batch-size-1-1">
<section id="section-a.1.2.1">
            <h4 id="name-test-vector-1-batch-size-1-2">
<a href="#section-a.1.2.1" class="section-number selfRef">A.1.2.1. </a><a href="#name-test-vector-1-batch-size-1-2" class="section-name selfRef">Test Vector 1, Batch Size 1</a>
            </h4>
<div class="artwork art-text alignLeft" id="section-a.1.2.1-1">
<pre>
Input = 00
Blind = 89c61a42c8191a5ca41f2fe959843d333bcf43173b7de4c5c119e0e0d8b0
e707
BlindedElement = 78a09c84ecf234df4a46c3695f1be3b9c045476b6826bc7bc78
27c29a4978022
EvaluationElement = 5679669e01363a05e3da803c0b0cd76bffecd8048ec81eee
b391b7301e93aa2e
UnblindedElement = 269a8a1f845eb7a767b8b2706198388bad8271bdbb5fac48e
e2b21116395631f
EvaluationProofC = 673b5e2d75540afdacd7b6183c3a84323f1822b60c8ee9d90
088fa3b3a508908
EvaluationProofS = a1edd24e73bffabff314d9cc7ad1af6f0b2cae7ec88bcef08
e7efedc9d0eb00e
Info = 4f505246207465737420766563746f7273
Output = 004c3577d9172f6b7c08e522db912d9138e38d5aca725c79c9029d06dba
26b026fb261f40041e86e057ab964227f278cf561c8155a2123baf8d256f603ebbb0
e
</pre><a href="#section-a.1.2.1-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="test-vector-2-batch-size-1-1">
<section id="section-a.1.2.2">
            <h4 id="name-test-vector-2-batch-size-1-2">
<a href="#section-a.1.2.2" class="section-number selfRef">A.1.2.2. </a><a href="#name-test-vector-2-batch-size-1-2" class="section-name selfRef">Test Vector 2, Batch Size 1</a>
            </h4>
<div class="artwork art-text alignLeft" id="section-a.1.2.2-1">
<pre>
Input = 5a5a5a5a5a5a5a5a5a5a5a5a5a5a5a5a5a
Blind = 8d665022e9ad52b74c04a426f8af36205e81997c2175079b22a0b0a16270
c909
BlindedElement = 8e7060a2608dbbb1ba03922d7c633daca752400da8ee75af792
5e1affcf99871
EvaluationElement = a8208b606a6af1f7e2c5b155f908197aa786aba72585103b
ba35fa9ad703f426
UnblindedElement = ccfa691bc7c0bd5a19546bc748fecca1661480fe304e881b4
ce661766ac2cf76
EvaluationProofC = 025e0a1e109baa97cea27550cf432d596e48bab2b1b0cf95c
9af25fd89431e06
EvaluationProofS = 295f8cb05f90f6c28b9e707fe5acc29dbe31b50375a64403f
965116afe5d7501
Info = 4f505246207465737420766563746f7273
Output = 449a8e7f559b4a6e67fa505b6d78b0be86eac3cbc9410af5666400a7fbc
5870aa15f67443473b87ef333b996f6128fa0174f85ab1a0a9cf5d5f89398a178799
c
</pre><a href="#section-a.1.2.2-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="test-vector-3-batch-size-2">
<section id="section-a.1.2.3">
            <h4 id="name-test-vector-3-batch-size-2">
<a href="#section-a.1.2.3" class="section-number selfRef">A.1.2.3. </a><a href="#name-test-vector-3-batch-size-2" class="section-name selfRef">Test Vector 3, Batch Size 2</a>
            </h4>
<div class="artwork art-text alignLeft" id="section-a.1.2.3-1">
<pre>
Input = 00,5a5a5a5a5a5a5a5a5a5a5a5a5a5a5a5a5a
Blind = 3af5aec325791592eee4a8860522f8444c8e71ac33af5186a9706137886d
ce08,8bcb0b70dac18de24eef12e737d6b28724d3e37774e0b092f9f70b255defaf0
4
BlindedElement = b8a0b4d0c056628131cd8ed1ea87cacecf6e09740c14a32c3e0
a2820e43afb3c,50a6b8dc62e95ac34320d7ceac08f4002710fdc49e56bde78b092d
01cad93e50
EvaluationElement = 12619d1c02de52189fa92f312eabe3062f627f0a75ccacd4
16d6dd2b71286e31,0093e963653200cacd9215833086a59e333db4b5f260db6a44c
81e8c7de59a5e
UnblindedElement = 269a8a1f845eb7a767b8b2706198388bad8271bdbb5fac48e
e2b21116395631f,ccfa691bc7c0bd5a19546bc748fecca1661480fe304e881b4ce6
61766ac2cf76
EvaluationProofC = 5ed544c7e6b8f8ab3d15d1650577a76107ba28986c6a600f4
eceff259110e40a
EvaluationProofS = 1cf74024f8d29c73d92d536b60e196d78bdeaf6c3481b62e8
cd8cf85c128be03
Info = 4f505246207465737420766563746f7273
Output = 004c3577d9172f6b7c08e522db912d9138e38d5aca725c79c9029d06dba
26b026fb261f40041e86e057ab964227f278cf561c8155a2123baf8d256f603ebbb0
e,449a8e7f559b4a6e67fa505b6d78b0be86eac3cbc9410af5666400a7fbc5870aa1
5f67443473b87ef333b996f6128fa0174f85ab1a0a9cf5d5f89398a178799c
</pre><a href="#section-a.1.2.3-1" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="oprfdecaf448-sha-512-1">
<section id="section-a.2">
        <h2 id="name-oprfdecaf448-sha-512-2">
<a href="#section-a.2" class="section-number selfRef">A.2. </a><a href="#name-oprfdecaf448-sha-512-2" class="section-name selfRef">OPRF(decaf448, SHA-512)</a>
        </h2>
<div id="base-mode-1">
<section id="section-a.2.1">
          <h3 id="name-base-mode-2">
<a href="#section-a.2.1" class="section-number selfRef">A.2.1. </a><a href="#name-base-mode-2" class="section-name selfRef">Base Mode</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-a.2.1-1">
<pre>
skSm = c4d5a15f0d5ffc354e340454ec779f575e4573a3886ab5e57e4da2985cea9
e32f6d95539ce2c7189e1bd7462a21723e92e2e9955ef20a92c
</pre><a href="#section-a.2.1-1" class="pilcrow">¶</a>
</div>
<div id="test-vector-1-batch-size-1-2">
<section id="section-a.2.1.1">
            <h4 id="name-test-vector-1-batch-size-1-3">
<a href="#section-a.2.1.1" class="section-number selfRef">A.2.1.1. </a><a href="#name-test-vector-1-batch-size-1-3" class="section-name selfRef">Test Vector 1, Batch Size 1</a>
            </h4>
<div class="artwork art-text alignLeft" id="section-a.2.1.1-1">
<pre>
Input = 00
Blind = 5843ebd3618d4fad8b7288477da50bed9befa58af639ddd950fec34205f8
a4f166fadcb8fa71a3ffdd2e98f422bf7b99be19f7da1fab583c
BlindedElement = 84be45bb776f8f15e8ed716663a010773cb44ad3b2c4dc66948
c2972bac99913308f160737e3f32a44349584a4b6ef4adf924f5fcc192d17
EvaluationElement = a6cf272ceb18e8f6abcf9216819b0b2265ad10502633d087
1b102b5ea7f574d9c6852af32f1082b578878bd09709df1897aa064f52b16414
UnblindedElement = 0cedeea1ef6934cff2d95b2af842806d7364312d8845504ae
31dac84511a92285d20cb281e13797f37b4415f117915106b9bf3a0a462eee9
Info = 4f505246207465737420766563746f7273
Output = 00b4c47498785b196ae032096d1c72bbf2c08c62215c3b40c4d696064f8
5f5d9224fc642322d65b7e72e6efcfc2d3bcf86bc7fb73ca2add97028eea3445882a
6
</pre><a href="#section-a.2.1.1-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="test-vector-2-batch-size-1-2">
<section id="section-a.2.1.2">
            <h4 id="name-test-vector-2-batch-size-1-3">
<a href="#section-a.2.1.2" class="section-number selfRef">A.2.1.2. </a><a href="#name-test-vector-2-batch-size-1-3" class="section-name selfRef">Test Vector 2, Batch Size 1</a>
            </h4>
<div class="artwork art-text alignLeft" id="section-a.2.1.2-1">
<pre>
Input = 5a5a5a5a5a5a5a5a5a5a5a5a5a5a5a5a5a
Blind = 5a9d35a225ec6340149a0aaf99870019c3d002aa4cfcf281657cf36fe562
bc60d9133e0e72a74432f685b2b620a55561604bb5783ca7f11d
BlindedElement = f0d1f1eb43b85e6dde38c0526151db3745b672667bef97bb0a3
553e191ad47f8c04e4a4c1588f028afecc170f15baeea2d44e86fe67982f8
EvaluationElement = f60cf47549fa62e72ae7253a4d42a8fc6ca70e0ac0ddc319
30627692eb3096792cf988115f792c99c03b08b0a5d07f2a2b7141dcb8c73cb9
UnblindedElement = a8d2cfdb49a2d1409a53656cbdf12829ccb6fcad73807727d
c2eaa4499e45f0af4cce88b443bedfc4cd08e9cdede61fd243e089a4f010a0f
Info = 4f505246207465737420766563746f7273
Output = a501a44719ed91d77ec885d3a9f17cd63d9784d66a1cfd71f3932ba7274
bcd2a507a50ef2dfa4a70595133f14fdec401284768b9b969b9a97503d5ae67c7642
d
</pre><a href="#section-a.2.1.2-1" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="verifiable-mode-1">
<section id="section-a.2.2">
          <h3 id="name-verifiable-mode-2">
<a href="#section-a.2.2" class="section-number selfRef">A.2.2. </a><a href="#name-verifiable-mode-2" class="section-name selfRef">Verifiable Mode</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-a.2.2-1">
<pre>
skSm = eb9e7aea3e4839413997e020f9377b63c13584156a09a46dd2a425c41eac0
e313a47e99d05df72c6e1d58e654a5ee9354b1150602f6adf2d
pkSm = 3ae16a2f8c506ebef74fafa9190e19447b07772e3077300b758411b941d8d
61f6b1840b35a73578f6aeb09e1a302a9d68f1db1cb34e90014
</pre><a href="#section-a.2.2-1" class="pilcrow">¶</a>
</div>
<div id="test-vector-1-batch-size-1-3">
<section id="section-a.2.2.1">
            <h4 id="name-test-vector-1-batch-size-1-4">
<a href="#section-a.2.2.1" class="section-number selfRef">A.2.2.1. </a><a href="#name-test-vector-1-batch-size-1-4" class="section-name selfRef">Test Vector 1, Batch Size 1</a>
            </h4>
<div class="artwork art-text alignLeft" id="section-a.2.2.1-1">
<pre>
Input = 00
Blind = d83e00cbb8559f84cb7a221b235b0950a0ab553f03f10e1386abe954011b
7da62bb6599418ef90b5d4ea98cca1bcd65fa514f189d2b31a07
BlindedElement = 54c5fd05a11cd041f09a80db5e8a327b654d24563178b25a128
b549d32857167062e3ba259de5e938e3635af9d17fdb3cc38fe43d21951b5
EvaluationElement = 5e284dc6fecae55bb6263a03ca772979ea559b28c8ba316d
4fe3e8c6c38649455982f31f84679aa5db3264613671ab238a9950a28b5d6471
UnblindedElement = 62a06f98dd6e56123081d519d3926ef6a0b3dd02659ec470b
f60ad2bdab709fe11d88e74168d1110245cda7ad654340ea2430ca86974e166
EvaluationProofC = c4af97abc45ca793c288bcf789fddb91ba97f4facb814a920
b58f06174b67accd626d212126c14db4276d4e0bd196dad3c1183c6d8e5fe3d
EvaluationProofS = c664d2dabd679ab657ac57a195bfbcdb82b7fbf105cc0118c
1b568875eafb64d504d72a7e2dc697b85358859115c51ee50ae348b411a841d
Info = 4f505246207465737420766563746f7273
Output = edaedd902e87de49fda24f501053500648e0c87fb59807976cbf568f9b0
209047cb1a0921e35270fe1c71153cc2c2b4ba80ba004a1d4a40fedd29e3c7fab356
c
</pre><a href="#section-a.2.2.1-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="test-vector-2-batch-size-1-3">
<section id="section-a.2.2.2">
            <h4 id="name-test-vector-2-batch-size-1-4">
<a href="#section-a.2.2.2" class="section-number selfRef">A.2.2.2. </a><a href="#name-test-vector-2-batch-size-1-4" class="section-name selfRef">Test Vector 2, Batch Size 1</a>
            </h4>
<div class="artwork art-text alignLeft" id="section-a.2.2.2-1">
<pre>
Input = 5a5a5a5a5a5a5a5a5a5a5a5a5a5a5a5a5a
Blind = ec86c5379228da260159dc24f7c5c2483a81aff8d9ff676ebd81db28eb1e
147561c478a3f84cbf77037f010272fd51abcff08ac9a7fcea16
BlindedElement = 9ca39b9c495b8fb1824923cd4b564a37e3921c7c6eeb799d448
9038f8b24388e858e67a461b776318eeb7fc1c59eb7e3f32b341a5b5d2308
EvaluationElement = ecf902b012dbd2cdf5de49ca99e2251948c93d345f7d4a6d
42b5ea5cd321ccdded0f89cfd63b3c77afe22924924814299e595a8656c2f56b
UnblindedElement = ba5084a399f858f5e43c959f207ce4707d63e921d82f1dc9c
aadb4361b56953c63ea8d41baadbf2d0ba63ab490cbcc8856d9d53e46efc7d4
EvaluationProofC = d5672632ceb780f677397bcb06a362e7169f4829369e6d044
372294618677e3f2032a85d9ce8f1e41bd8194f35c81bc799927720ba763934
EvaluationProofS = bf4db6f201ba01cf6e58b1be9491cc5b2aa8ddd5498c0dbdf
fa99bd7f6539d36a9c6737e1302af33e6ab4a48b8bec87ef4f41296fff11a14
Info = 4f505246207465737420766563746f7273
Output = fda088c9c6b87dc7ecdf30016164c33b25bc32b6f5bce9fb161de869d81
0eb844572c3e7f20bbdda5c049cf568b8499dfbfcc653862d1ede19b2602698049a5
7
</pre><a href="#section-a.2.2.2-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="test-vector-3-batch-size-2-1">
<section id="section-a.2.2.3">
            <h4 id="name-test-vector-3-batch-size-2-2">
<a href="#section-a.2.2.3" class="section-number selfRef">A.2.2.3. </a><a href="#name-test-vector-3-batch-size-2-2" class="section-name selfRef">Test Vector 3, Batch Size 2</a>
            </h4>
<div class="artwork art-text alignLeft" id="section-a.2.2.3-1">
<pre>
Input = 00,5a5a5a5a5a5a5a5a5a5a5a5a5a5a5a5a5a
Blind = 5b6f602b4b20a570a697452b3ddbb7d0e29363adebbcb5673294396b0b4e
7edc4adfc97a75132d92a1da241baff84fada3e7b12d569c0b3f,ad9ba734d54c2b2
4bff0ef6310404b5c05d60d7c258cea6500229ee057507c3e53534ad9db9f6df6ce5
15d1b8017923b65cada19e7a49a18
BlindedElement = ae30869b3292b406ffae15145f8d056232cc6c6b6ea9d49004f
d3a2492aa2770e28b0ee344ad438180deacf501ec54cae7c1f8b0c4e6958b,54fbd3
7ead128577c7536a862d018b29c3dbc9da09e6cbb9d7a96013b6ac8f9d0b1599cfd5
9292ea9ef95240c9e8796b41e49b3037b4984c
EvaluationElement = 92fe4293f5dad22e44e91659b20ee0e5fdf5f805d9148ee4
9573081aea607cf9e05ce16c802cf76db06b3f95d40175829c2950fd5ad1a82d,e60
a930f90ab1eca807b057200fb997c68808aab811cbde365451f86c4132684e613410
b00f39b7f080fd37ed4149cf3df5e7152ff8004b1
UnblindedElement = 62a06f98dd6e56123081d519d3926ef6a0b3dd02659ec470b
f60ad2bdab709fe11d88e74168d1110245cda7ad654340ea2430ca86974e166,ba50
84a399f858f5e43c959f207ce4707d63e921d82f1dc9caadb4361b56953c63ea8d41
baadbf2d0ba63ab490cbcc8856d9d53e46efc7d4
EvaluationProofC = e9dba5de07f66d9fc40707c6bb0c69b893e0291d76402d829
76696ee0247b94bb6697e8d5e93963e48e057ad5978c49a4f8c781ff2004c1e
EvaluationProofS = 9d1227714a1807d72566bfc06ae807e8900bce5c7fd6511ad
112a3734b3c192f3b9979c3357dee5c7df933830c299a5422d0e2d7ebe59a21
Info = 4f505246207465737420766563746f7273
Output = edaedd902e87de49fda24f501053500648e0c87fb59807976cbf568f9b0
209047cb1a0921e35270fe1c71153cc2c2b4ba80ba004a1d4a40fedd29e3c7fab356
c,fda088c9c6b87dc7ecdf30016164c33b25bc32b6f5bce9fb161de869d810eb8445
72c3e7f20bbdda5c049cf568b8499dfbfcc653862d1ede19b2602698049a57
</pre><a href="#section-a.2.2.3-1" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="oprfp-256-sha-256-1">
<section id="section-a.3">
        <h2 id="name-oprfp-256-sha-256-2">
<a href="#section-a.3" class="section-number selfRef">A.3. </a><a href="#name-oprfp-256-sha-256-2" class="section-name selfRef">OPRF(P-256, SHA-256)</a>
        </h2>
<div id="base-mode-2">
<section id="section-a.3.1">
          <h3 id="name-base-mode-3">
<a href="#section-a.3.1" class="section-number selfRef">A.3.1. </a><a href="#name-base-mode-3" class="section-name selfRef">Base Mode</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-a.3.1-1">
<pre>
skSm = 2902c13bdc9993d3717bda68fc080b9802ae4effd5dc972d9f9fb3bbbf106
ade
</pre><a href="#section-a.3.1-1" class="pilcrow">¶</a>
</div>
<div id="test-vector-1-batch-size-1-4">
<section id="section-a.3.1.1">
            <h4 id="name-test-vector-1-batch-size-1-5">
<a href="#section-a.3.1.1" class="section-number selfRef">A.3.1.1. </a><a href="#name-test-vector-1-batch-size-1-5" class="section-name selfRef">Test Vector 1, Batch Size 1</a>
            </h4>
<div class="artwork art-text alignLeft" id="section-a.3.1.1-1">
<pre>
Input = 00
Blind = 359073c015b92d15450f7fb395bf52c6ea98384c491fe4e4d423b59de7b0
df39
BlindedElement = 03774b90bbb29af011e08dcb31ec7aa5f902afe02338f96d6b8
17400f7d77d987f
EvaluationElement = 02350c80b07aa03da012f7d9162645673bd3535a89b96bf5
2f4f0d9b026610b325
UnblindedElement = 036421a5471d3efcdd941dd85b511939ffbee330d8c96ac5e
1a529cc428eab3aeb
Info = 4f505246207465737420766563746f7273
Output = 5cd0e305a01b99f65cb4e423cf26ecff44cc42d279d390e4b35694bb51d
ff677
</pre><a href="#section-a.3.1.1-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="test-vector-2-batch-size-1-4">
<section id="section-a.3.1.2">
            <h4 id="name-test-vector-2-batch-size-1-5">
<a href="#section-a.3.1.2" class="section-number selfRef">A.3.1.2. </a><a href="#name-test-vector-2-batch-size-1-5" class="section-name selfRef">Test Vector 2, Batch Size 1</a>
            </h4>
<div class="artwork art-text alignLeft" id="section-a.3.1.2-1">
<pre>
Input = 5a5a5a5a5a5a5a5a5a5a5a5a5a5a5a5a5a
Blind = b5e8f3c63b86ae88d9ce0530b01cb1c23382c7ec9bdd6e75898e4877d8e2
bc17
BlindedElement = 03ec4301d1d42a4582588a9258413a28cd997de3468e198f463
eadbffcc2adeaa5
EvaluationElement = 03807af5cbdbf6c56842f866b87c69f7b9fc4ab8d891353d
f97395f63145c9aea2
UnblindedElement = 03bbf0692f18ec393df3755ae5fcf0473ba4c924fc32dd118
40dd196bdf15471c0
Info = 4f505246207465737420766563746f7273
Output = 8dfc020a5820501b479ab9dd1a9ccf8a6f0c5db7c12c1b7aa06cd4e8df5
d35a7
</pre><a href="#section-a.3.1.2-1" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="verifiable-mode-2">
<section id="section-a.3.2">
          <h3 id="name-verifiable-mode-3">
<a href="#section-a.3.2" class="section-number selfRef">A.3.2. </a><a href="#name-verifiable-mode-3" class="section-name selfRef">Verifiable Mode</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-a.3.2-1">
<pre>
skSm = 4283efb9cd1ee4061c6bf884e60a877321ece4f9b6ffd01ce82082545413b
d9c
pkSm = 03c335d2eebd0ccbd5b8a145c9c2ee7452f401dcd4301ab138b0b56fc1c72
769cb
</pre><a href="#section-a.3.2-1" class="pilcrow">¶</a>
</div>
<div id="test-vector-1-batch-size-1-5">
<section id="section-a.3.2.1">
            <h4 id="name-test-vector-1-batch-size-1-6">
<a href="#section-a.3.2.1" class="section-number selfRef">A.3.2.1. </a><a href="#name-test-vector-1-batch-size-1-6" class="section-name selfRef">Test Vector 1, Batch Size 1</a>
            </h4>
<div class="artwork art-text alignLeft" id="section-a.3.2.1-1">
<pre>
Input = 00
Blind = 102f6338df84c9602bfa9e7d690b1f7a173d07e6d54a419db4a6308f8b09
589f
BlindedElement = 024829172675a0f6036657cd5d9eb0cfb97cad2eae79dfe5166
095d4db0fe4a49c
EvaluationElement = 02fef714dc9464983baca86fee8857a6afec020a9ea9440d
31f141c5957e04f494
UnblindedElement = 03e0d6dcbce22e122a441c27828bf5867ae91ef0287af662e
24f47b31e2bc92ae2
EvaluationProofC = 2d0c60ea2211b48ef1c3924d5243fe81a1c9155c6578af08e
664565d3816ac6a
EvaluationProofS = 074d637aa4522b51dcee362a9ed306b6b8a54727f7b4e5ab8
c3b3e1c6e5ce02c
Info = 4f505246207465737420766563746f7273
Output = c4480a76725eb8adbb28ed9b36fe93537132b9981baf854ef31651bf08d
589e2
</pre><a href="#section-a.3.2.1-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="test-vector-2-batch-size-1-5">
<section id="section-a.3.2.2">
            <h4 id="name-test-vector-2-batch-size-1-6">
<a href="#section-a.3.2.2" class="section-number selfRef">A.3.2.2. </a><a href="#name-test-vector-2-batch-size-1-6" class="section-name selfRef">Test Vector 2, Batch Size 1</a>
            </h4>
<div class="artwork art-text alignLeft" id="section-a.3.2.2-1">
<pre>
Input = 5a5a5a5a5a5a5a5a5a5a5a5a5a5a5a5a5a
Blind = 076f08753056c186437ded8ee22f96e44bd5b6ec07cb131d51cf1324c123
8699
BlindedElement = 03de136afec7e193e73d28d83e84a2b31b4532da77b8ee9a053
ad209873e3841cb
EvaluationElement = 03e2ce505dcac913ed1e29c1dd34cc3e3079887ee5775420
1e0642ede25538e27e
UnblindedElement = 037dd1c0daf493d8a2ab3a2b4fe2528caec6aba63d0a48303
2860abf8bd8ea74f3
EvaluationProofC = 238f041989e3e71ff5ee25e86566c76e4366baa819bbfbfbc
4757cdd2f3fc6d5
EvaluationProofS = 766c01412f32e6740972e4b5fda0563e3720faecdd4aaedeb
ba0bba84248aa04
Info = 4f505246207465737420766563746f7273
Output = f3070e5c02a7795585b5313df451739b99f6c47537c1a0f64790485bc7a
b6c00
</pre><a href="#section-a.3.2.2-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="test-vector-3-batch-size-2-2">
<section id="section-a.3.2.3">
            <h4 id="name-test-vector-3-batch-size-2-3">
<a href="#section-a.3.2.3" class="section-number selfRef">A.3.2.3. </a><a href="#name-test-vector-3-batch-size-2-3" class="section-name selfRef">Test Vector 3, Batch Size 2</a>
            </h4>
<div class="artwork art-text alignLeft" id="section-a.3.2.3-1">
<pre>
Input = 00,5a5a5a5a5a5a5a5a5a5a5a5a5a5a5a5a5a
Blind = bb1876a7f7165ac7ec79bfd5213ea2e374252f29a6e19915f81b0c7dcea9
3ce7,e04f47e8d2554a5ebd83679b4c1e67ed82f2891751aa7094602be672c324929
b
BlindedElement = 0245a57f9e991bb3661c3343772cdb16cc16217d441e0847c7d
4ae8eaad41a980f,0375e7898d32f42e0479a8bd7017378604df8d3eddee91f3a5e7
0df7126fe8050d
EvaluationElement = 030eb61d8599b8703ae0cd1c5b988d4dc9bf77645c2ce9b5
0f6e8bcee1149cd5a5,03f6055d4cb2471940ed0ee2b647a0cf89a283484c29febbf
2d49a7d77e7f23c4c
UnblindedElement = 03e0d6dcbce22e122a441c27828bf5867ae91ef0287af662e
24f47b31e2bc92ae2,037dd1c0daf493d8a2ab3a2b4fe2528caec6aba63d0a483032
860abf8bd8ea74f3
EvaluationProofC = ffeb7a787565a5d23f0b3b5c2c6064ee1d0aa69e98f7bbe04
7c14a7b924f11f3
EvaluationProofS = f8c99cb8557db8f77509a041a5fb9bf7df9d50e538cb68bba
59adefc7b4a6985
Info = 4f505246207465737420766563746f7273
Output = c4480a76725eb8adbb28ed9b36fe93537132b9981baf854ef31651bf08d
589e2,f3070e5c02a7795585b5313df451739b99f6c47537c1a0f64790485bc7ab6c
00
</pre><a href="#section-a.3.2.3-1" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="oprfp-384-sha-512-1">
<section id="section-a.4">
        <h2 id="name-oprfp-384-sha-512-2">
<a href="#section-a.4" class="section-number selfRef">A.4. </a><a href="#name-oprfp-384-sha-512-2" class="section-name selfRef">OPRF(P-384, SHA-512)</a>
        </h2>
<div id="base-mode-3">
<section id="section-a.4.1">
          <h3 id="name-base-mode-4">
<a href="#section-a.4.1" class="section-number selfRef">A.4.1. </a><a href="#name-base-mode-4" class="section-name selfRef">Base Mode</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-a.4.1-1">
<pre>
skSm = 06cc9faa9dc7ab251997738a3a232f352c2059c25684e6ccea420f8d0c793
f9f51171628f1d28bb7402ca4aea6465e27
</pre><a href="#section-a.4.1-1" class="pilcrow">¶</a>
</div>
<div id="test-vector-1-batch-size-1-6">
<section id="section-a.4.1.1">
            <h4 id="name-test-vector-1-batch-size-1-7">
<a href="#section-a.4.1.1" class="section-number selfRef">A.4.1.1. </a><a href="#name-test-vector-1-batch-size-1-7" class="section-name selfRef">Test Vector 1, Batch Size 1</a>
            </h4>
<div class="artwork art-text alignLeft" id="section-a.4.1.1-1">
<pre>
Input = 00
Blind = ae86286729214a1ba9a359ab01833477b8cb91932d0c81667a0e3244b896
ac141b538ff23749be19e92df82df1acd3f7
BlindedElement = 0256ec771e8a7b770ff9ab40efb499279ed9a71d36ab6bc7d40
cd64565c66c2db285b8fe58f47e68bf3c02b98c90684aaa
EvaluationElement = 02bdf50a96769acb293d3ba11a124c6b784e921d2d3d3112
eb696a998a0a3464c9c27f6eddf8a270ac721678e75e7df344
UnblindedElement = 0339cc6aa5b5ef9bd0ba57b1f317e17d8aac3311c1fd6e581
ae84b4af19f4d4efd2877a8e127a7141cbedbbebd77826192
Info = 4f505246207465737420766563746f7273
Output = bd2fc54549a028c19de0fa14e772be2e17324b9b8f66c3fbc511c355b78
c4eb5d841c365816f2a89a250c225eedc6ab9c312dc2945722d3265f05fe16ef5762
9
</pre><a href="#section-a.4.1.1-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="test-vector-2-batch-size-1-6">
<section id="section-a.4.1.2">
            <h4 id="name-test-vector-2-batch-size-1-7">
<a href="#section-a.4.1.2" class="section-number selfRef">A.4.1.2. </a><a href="#name-test-vector-2-batch-size-1-7" class="section-name selfRef">Test Vector 2, Batch Size 1</a>
            </h4>
<div class="artwork art-text alignLeft" id="section-a.4.1.2-1">
<pre>
Input = 5a5a5a5a5a5a5a5a5a5a5a5a5a5a5a5a5a
Blind = 523eff8db014d9b8b53ad7b0e149b0938b45f65717a40c38f671d326e196
e8a21bf6cfd40327a95f1ccfc82a9f83a75e
BlindedElement = 03a4badb8d617e78f7df557e183d01e1284920f5e84bc916b41
85b20f57129a09a301e57d4ea93463f398c31b52934e91c
EvaluationElement = 029fffdcadf404bec3ac2a120a0e4df38c6563e691cd256c
6fe6adaabb0362097b6026ae3c6e2995cf5f0c18548e6706af
UnblindedElement = 035540b79d5a64cb696cf0310692cbadd391d5de2f19f838b
17264d5117a0813489c9a28a604e3ed56b00aeb5931391cb1
Info = 4f505246207465737420766563746f7273
Output = 1f67938dc2d31c474797f03958ec3afb4e2eb3c5a12341bba921959f763
3ee53fa36496fbbe1cd40194f54250506ce905f782a5341451915fee8f13593028a6
f
</pre><a href="#section-a.4.1.2-1" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="verifiable-mode-3">
<section id="section-a.4.2">
          <h3 id="name-verifiable-mode-4">
<a href="#section-a.4.2" class="section-number selfRef">A.4.2. </a><a href="#name-verifiable-mode-4" class="section-name selfRef">Verifiable Mode</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-a.4.2-1">
<pre>
skSm = 32370deb7c3c17d9fc7cb4e0ce646e04e42d638e0fa7a434ed340772a8b5d
6253d35895f4cff282d86b2358d89a82ee7
pkSm = 023112a158597bf66974ec2391209063aa489fc1e98fec51be3a81aeeac03
b94dea1deee98515dc73c060a1432913d1a5d
</pre><a href="#section-a.4.2-1" class="pilcrow">¶</a>
</div>
<div id="test-vector-1-batch-size-1-7">
<section id="section-a.4.2.1">
            <h4 id="name-test-vector-1-batch-size-1-8">
<a href="#section-a.4.2.1" class="section-number selfRef">A.4.2.1. </a><a href="#name-test-vector-1-batch-size-1-8" class="section-name selfRef">Test Vector 1, Batch Size 1</a>
            </h4>
<div class="artwork art-text alignLeft" id="section-a.4.2.1-1">
<pre>
Input = 00
Blind = bbabe8add48bcd149ff3b840dc8a5d2483705fcc9a39607288b935b0797a
c6b3c4b2e848823ac9ae16b3a3b5816be035
BlindedElement = 0255b8e051b51b644548304894e2f41b012075a807d5dc27169
7322cc057e19834c6f47e24309e2e102e44c92c321694a0
EvaluationElement = 03fbffe94ed4b87bbee72fbdc3d7698bc7f9e39af32a1612
ba1c4c2d626678754c0675644a67d7a9e6fdcb2da882018328
UnblindedElement = 03f76b2ddddcce5db5504f77d07eeccd8302436818c4882b2
93499f31255b139aa3ed920002dc2e201b725de580b251852
EvaluationProofC = 9bc67e891fcd80112dfe7deb70182bebe509b470fe0f194a0
3d16cdcdb2a3a8008ec19ba26366ca6bb8809af6a44e7e0
EvaluationProofS = 73a2a536c65b6fff02eb9615d7c08490f3d0cedf789a6d791
cb3b98592f5e1941fa92746fb73f186b534e27b540e0c2c
Info = 4f505246207465737420766563746f7273
Output = 9a98a6a359a99bf6549689badbb8ebfde6d5a3b6290af2165301a41a082
d8f36fdb8937d48d41189932f052c4523683cf216aeb7b57dc61f268e9a67f684ef4
5
</pre><a href="#section-a.4.2.1-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="test-vector-2-batch-size-1-7">
<section id="section-a.4.2.2">
            <h4 id="name-test-vector-2-batch-size-1-8">
<a href="#section-a.4.2.2" class="section-number selfRef">A.4.2.2. </a><a href="#name-test-vector-2-batch-size-1-8" class="section-name selfRef">Test Vector 2, Batch Size 1</a>
            </h4>
<div class="artwork art-text alignLeft" id="section-a.4.2.2-1">
<pre>
Input = 5a5a5a5a5a5a5a5a5a5a5a5a5a5a5a5a5a
Blind = 0470f06169bee12cf47965b72a59946ca387966f5d8331eab82117c88bbd
91b8954e16c0b9ceed3ce992b198be1ebfbb
BlindedElement = 0358930b1c57b54bf884d0b76904f11a4a139935e94ddc55287
678f041e9a9dc1f435a68f74df8c9d5febd1a4d910ad9fa
EvaluationElement = 02636fea7f2b916749f2eab123a9eff087688d8e5a7c2d95
df91b6defe1e0180c5272c9866ae95ad9697ae96c70967cc84
UnblindedElement = 0330d4bfdc5dab25ed4813570b4975b16a6fd0202bb2373a0
0edcb008ac105f51216837973cd29f20744eac13619ce28a2
EvaluationProofC = a79fe0ddd80f3ad91257ad638e6f80328c0779b3e9f90ef14
bb0be6e9131bb268b030562302eb0387ed95fbd6effb086
EvaluationProofS = af5524e526e0649fce351adcf199251a0f3dc2ec93c885652
09a64c95ebe5b03ed88f75e1cd1835bf87b3c1c8c3519e6
Info = 4f505246207465737420766563746f7273
Output = 6f1bca7bea7fe041f764528e17ff55a4c0d4eb96f98e06f4b005f1cd1e0
f973875b752079f1faf5397eec89a6bcd90c037914b5f9e4cda1f423909ae080c3de
2
</pre><a href="#section-a.4.2.2-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="test-vector-3-batch-size-2-3">
<section id="section-a.4.2.3">
            <h4 id="name-test-vector-3-batch-size-2-4">
<a href="#section-a.4.2.3" class="section-number selfRef">A.4.2.3. </a><a href="#name-test-vector-3-batch-size-2-4" class="section-name selfRef">Test Vector 3, Batch Size 2</a>
            </h4>
<div class="artwork art-text alignLeft" id="section-a.4.2.3-1">
<pre>
Input = 00,5a5a5a5a5a5a5a5a5a5a5a5a5a5a5a5a5a
Blind = a0d61b2f5a8a2a1143368327f3077c68a1545e9aafbba6a90dc0d4094ba4
283237211e139f306fc904c2d4fe4cc69c0b,90320718eff747e2482562df55c99bf
9591cb0eab2a72d044c05ca2cc2ef9b609a38546f74b6d688f70cf205f782fa12
BlindedElement = 0332a05819c8b2c1165d104b43e0b3e2fd49b17dd5e2a3c84bd
a805dbcebf20860d3a063d552f1190c6f79e64f01e6aee5,0337e5bd41e1b763aac3
39f488b158014a31addc5a8c69cdd4fcdc11305dca89fce402fd0ea27f5a6effc82d
bfb8fc7557
EvaluationElement = 03085806170058c5189010e315013a68259e862c08e6ef21
c40b9068dabc4187f611a303c57db80cdc3d9b4e537fcda75c,02936ab564ff79eea
ff16c3fdc176ba71c5351d60ec067daca44b7ebb3c106439ac0aaecaf9f8974a8326
90b8e17907150
UnblindedElement = 03f76b2ddddcce5db5504f77d07eeccd8302436818c4882b2
93499f31255b139aa3ed920002dc2e201b725de580b251852,0330d4bfdc5dab25ed
4813570b4975b16a6fd0202bb2373a00edcb008ac105f51216837973cd29f20744ea
c13619ce28a2
EvaluationProofC = 37de36448a3838fc074c4eb87e1dcda24d80cd8e90ebf778f
1e6c22a14e87e76691271324e656319cb572c2cf38906a1
EvaluationProofS = 89512f46b3282d5cc3cfc816f13ff6213ae66eb97316fcbb8
b1196e50708f3dead470f6913cc7b5bc4655f8a54aacbb4
Info = 4f505246207465737420766563746f7273
Output = 9a98a6a359a99bf6549689badbb8ebfde6d5a3b6290af2165301a41a082
d8f36fdb8937d48d41189932f052c4523683cf216aeb7b57dc61f268e9a67f684ef4
5,6f1bca7bea7fe041f764528e17ff55a4c0d4eb96f98e06f4b005f1cd1e0f973875
b752079f1faf5397eec89a6bcd90c037914b5f9e4cda1f423909ae080c3de2
</pre><a href="#section-a.4.2.3-1" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="oprfp-521-sha-512-1">
<section id="section-a.5">
        <h2 id="name-oprfp-521-sha-512-2">
<a href="#section-a.5" class="section-number selfRef">A.5. </a><a href="#name-oprfp-521-sha-512-2" class="section-name selfRef">OPRF(P-521, SHA-512)</a>
        </h2>
<div id="base-mode-4">
<section id="section-a.5.1">
          <h3 id="name-base-mode-5">
<a href="#section-a.5.1" class="section-number selfRef">A.5.1. </a><a href="#name-base-mode-5" class="section-name selfRef">Base Mode</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-a.5.1-1">
<pre>
skSm = 01b68fade716a6a82d600444b26de335ba38cf092d80c7cf2cb55388d8995
15238094c800bdd9c65f71780ba85f5ae9b4703e17e559ca3ccd1944f9a70536c175
f12
</pre><a href="#section-a.5.1-1" class="pilcrow">¶</a>
</div>
<div id="test-vector-1-batch-size-1-8">
<section id="section-a.5.1.1">
            <h4 id="name-test-vector-1-batch-size-1-9">
<a href="#section-a.5.1.1" class="section-number selfRef">A.5.1.1. </a><a href="#name-test-vector-1-batch-size-1-9" class="section-name selfRef">Test Vector 1, Batch Size 1</a>
            </h4>
<div class="artwork art-text alignLeft" id="section-a.5.1.1-1">
<pre>
Input = 00
Blind = 00dd0772f68b53baade9962d164565d8c0e3a1ba1a337759061965a423d9
d3d6e1e1006dc8984ad28a4c93ecfc36fc2171046b3c4284855cfa2434ed98db9e68
a598
BlindedElement = 0200c90f3a3d634131d2c6c28fb3c68cd4a2fcf645e02bf5dda
da3cd3400fe1a9b11c8149f74e97f305c6bbed99e4bf1d0e4e15648db2f7ca4d377f
d5e063767d8b878
EvaluationElement = 02015d9c192d77d428e77486ba09239c9e9666e3de62d578
7cade4d92e9017993607041fade15f90d8f6b45847b5f5a2c5355d7aa8696aa2a8a4
aef3b1f565c3c8010e
UnblindedElement = 03005e3cef397da7e8d193d31107ea2da163eca97b54d6d6e
cd664b9c5021834f355800657bbde325f9c4c5a5a64d5a7651d669b720e46674e069
14382182dcce16fc7
Info = 4f505246207465737420766563746f7273
Output = ee8408b7b6c93d0f47081bacd42f0890be817d2a6913f25974e04566bce
a2ac112cdbc8bc5d3bb8b83cb38c40c821ffac97f16ed56882fee4ba9b05b6f6539c
9
</pre><a href="#section-a.5.1.1-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="test-vector-2-batch-size-1-8">
<section id="section-a.5.1.2">
            <h4 id="name-test-vector-2-batch-size-1-9">
<a href="#section-a.5.1.2" class="section-number selfRef">A.5.1.2. </a><a href="#name-test-vector-2-batch-size-1-9" class="section-name selfRef">Test Vector 2, Batch Size 1</a>
            </h4>
<div class="artwork art-text alignLeft" id="section-a.5.1.2-1">
<pre>
Input = 5a5a5a5a5a5a5a5a5a5a5a5a5a5a5a5a5a
Blind = 00e8bea293aa8a69353b023f4a0e6a39eef47b0d4ca4c64825ba085de242
042b84d9ebe3b2e9de07678ff96713dfe16f40f2c662a56ed2db95e1e7bf2dea02bd
1fa8
BlindedElement = 02013e9e1424ad951f402f53dfea37908bba1e03bcb39984803
6620779fd2cab5d2d300e78600fcd256cb2d14ccaea3864561d848d561785ddabb3b
01b27155aae312a
EvaluationElement = 02014ccf9eeefaca351b8ddebe68b2682c98279a5222fe74
0cff6be1cd85c349bdea0e8be5bdb0e25ffa56f222076eaa823a625354809e34b08c
a8e7e7afd8465cfb14
UnblindedElement = 0301938d6f170ce442b762cf25f9d816d22d3ab10f4416aa0
6ee061aef19954a1a13b3910d243b3fe046e54cf19d16191d55230b92b4d0a004bff
74087453425630e1f
Info = 4f505246207465737420766563746f7273
Output = d1f8c49f41711a058e79850d97fb02bf9d02f4d5d014681d350a5e1656a
b1d6f656d939460bd9ab730aea22c4aad77b250c13d613f3f18ccc74f0e271e09806
6
</pre><a href="#section-a.5.1.2-1" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="verifiable-mode-4">
<section id="section-a.5.2">
          <h3 id="name-verifiable-mode-5">
<a href="#section-a.5.2" class="section-number selfRef">A.5.2. </a><a href="#name-verifiable-mode-5" class="section-name selfRef">Verifiable Mode</a>
          </h3>
<div class="artwork art-text alignLeft" id="section-a.5.2-1">
<pre>
skSm = 01449bb3b4ef3d5c65b55a1b8960563b3420d7764097502850c445ccd86e2
d20d7e4ec77617a4238835743037876080d2e3e27bc3ce7b5fb6a1107ffedeaedb37
177
pkSm = 02010dc16a63cb3e75fb306038b8364f55a1fff4e168538c4667cb1511260
ecae34fe14916ca1d19a0f2e208f537ae634751a9b85d80b33e9c02563de40c86d13
47679
</pre><a href="#section-a.5.2-1" class="pilcrow">¶</a>
</div>
<div id="test-vector-1-batch-size-1-9">
<section id="section-a.5.2.1">
            <h4 id="name-test-vector-1-batch-size-1-10">
<a href="#section-a.5.2.1" class="section-number selfRef">A.5.2.1. </a><a href="#name-test-vector-1-batch-size-1-10" class="section-name selfRef">Test Vector 1, Batch Size 1</a>
            </h4>
<div class="artwork art-text alignLeft" id="section-a.5.2.1-1">
<pre>
Input = 00
Blind = 0086b18e24c9a40ed5eec262bf51dc970d63acb5ab74318e54223c759e97
47f59c0d4ecbc087302667fabefa647b1766accb7c82a46aa3fc6caecbb9e935f0bf
b00f
BlindedElement = 03007023e7afe67d3c5a912bdc703e11822e3d72519a7724139
1958603e5356029f8a5ad66a71dd14054ffe6f5b5c5055a151dfcbaf36784c2cec4a
c3802681982afe2
EvaluationElement = 0301286ee7068eca78bff9786df0deba99abd288058f41fa
d91ba57cb5e946f37da2fb2486c70cc1570230b04b97fa1e732ff898ca032bb0fb11
955b70a226715368d5
UnblindedElement = 02006ff10e5a67d2f1b7dd74e5b3d927478b25eecd1cdf068
139f30dc269f9dc31805b0ef8f2481b922b3b8e90a7a821b3cdb5e0cb4ae4d64eac7
35693038b6cc4503e
EvaluationProofC = 01bff02b0ea6c9501a91d3a84f3a91c582f9216974a981efb
f5c7f7002ad96746a5d72a8430de6f69c22c2d2dc2ba69cc739990eef75b0daf90a2
c5f069569cd3974
EvaluationProofS = 01a08833077d1aec89a730429e8062e71bd085a1dbfaa7f68
953cbf3af5e05dffa7e040db2ee81c1b1f75d8d5d9015ea0fae55f10968c1577aa0e
38e718c4fc8ff80
Info = 4f505246207465737420766563746f7273
Output = 474928ccc8088a22c80d2205187eed5a7e31cdbdd50528de43b306a4958
269054059ce94e242cc3d3583537c7a399a283b65219ac9e33e9d44b396a6b889e21
1
</pre><a href="#section-a.5.2.1-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="test-vector-2-batch-size-1-9">
<section id="section-a.5.2.2">
            <h4 id="name-test-vector-2-batch-size-1-10">
<a href="#section-a.5.2.2" class="section-number selfRef">A.5.2.2. </a><a href="#name-test-vector-2-batch-size-1-10" class="section-name selfRef">Test Vector 2, Batch Size 1</a>
            </h4>
<div class="artwork art-text alignLeft" id="section-a.5.2.2-1">
<pre>
Input = 5a5a5a5a5a5a5a5a5a5a5a5a5a5a5a5a5a
Blind = 00b9f3ad744eb5baf418275e45ab31ade30669dbae98fb0879524fb9234e
93a8bd048ad9f44b428026396a810328c405a354e666f086fa0ea4754fb56527be01
0297
BlindedElement = 0200df8a5b7753f5a6a640e6db207649cb07e3a76931a40e9c4
0e54dce933c26f0450461b2885eab5a202485ba35ae2ff006964b88af4069b68b9c1
554c3e940e0b943
EvaluationElement = 0200736c0d07ce6ccda8f0a8e31218ed844f7729c9943881
1f0d91a3cab6b0cde7b726cd65f9622e757d06bd8dad2894601e1635b3d345193a7c
e47e2d58b5bfb5ffa3
UnblindedElement = 02001f091d698d71ab48a00104ef005dd1feb85ca48bc5d11
3c9e6c2df3f079b8888d1ef24e0bfee75d90c712bc5d7ecd655b32cb7f0259654bac
bf9766801ecc9a29f
EvaluationProofC = 019090a83fd579e254811a733469eaf9163efa8397bf61d54
bc9f0b3d919e2e92ffddcdf8639bbad1cd9696d9f568452eef1ced4a3861af505dcd
af6321c7b3a069d
EvaluationProofS = 00532d796210ea9e5eea285d358c8fdb4a1e8bc7559389276
5e13db6f64a52830fa2c55a1e5039f4aeea2309bdb1bb55f964113d4b25fd169cb91
fd93dce6afd6199
Info = 4f505246207465737420766563746f7273
Output = 963ee0b1ed3a319a8947b9fef093ddf270628c5987cab96bff89287f818
40486adc514c9f73568f4ac43ff84b113041137ca4837849b4bcb58c6d4c576cd4b1
5
</pre><a href="#section-a.5.2.2-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="test-vector-3-batch-size-2-4">
<section id="section-a.5.2.3">
            <h4 id="name-test-vector-3-batch-size-2-5">
<a href="#section-a.5.2.3" class="section-number selfRef">A.5.2.3. </a><a href="#name-test-vector-3-batch-size-2-5" class="section-name selfRef">Test Vector 3, Batch Size 2</a>
            </h4>
<div class="artwork art-text alignLeft" id="section-a.5.2.3-1">
<pre>
Input = 00,5a5a5a5a5a5a5a5a5a5a5a5a5a5a5a5a5a
Blind = 01daf5685928c72d9dab8ddfe45de734ce0d4ff5823d2e40c4fcf880e9a8
272b46eea593b1095e7d38ba6ff37c42b3c4859761247a74d0c62c98ddff1365bb9b
82b3,00b96540574e2bc92534ac475d6a3649f3e9cdf20a7e882066be571714f5db0
73555bc1bfebe1d50a04fd6656a439cf465109653bf8e484c01c5f8516f98f3159b4
0
BlindedElement = 0300d45e787f24a39c52cc290f0b202c03d320b1213a9dd4429
df6b7f455a954b85815b5b379db5b4b9d665abaaf26366c91b8cd4884a2cddbf5be0
7420726de773fb7,030122ca1ad84feb6dc2832373011608a6d7f7f8e632c66cc6e1
34de50aa4317caa9c9b11cb281ae7dea4286a7c217cb9937d470f28a8c800dce277a
759342dd9a3e0d
EvaluationElement = 0301d8af9135b69b174238acd802e31323e84f9f66c7d3ca
68659ccd4456f16af156c15d48c8d7003f64fc8d814d09e5e4f0bf54dfd719ddaf10
19f667ea0f9e58afed,0300e253175c05483e6696eb6447f4e3ae87c0764909749a6
4c902dbe11a8d575e59d13c86f499483f99d707d5485ca441e48cc9e0f78fbb22225
b91c8870f8d094aae
UnblindedElement = 02006ff10e5a67d2f1b7dd74e5b3d927478b25eecd1cdf068
139f30dc269f9dc31805b0ef8f2481b922b3b8e90a7a821b3cdb5e0cb4ae4d64eac7
35693038b6cc4503e,02001f091d698d71ab48a00104ef005dd1feb85ca48bc5d113
c9e6c2df3f079b8888d1ef24e0bfee75d90c712bc5d7ecd655b32cb7f0259654bacb
f9766801ecc9a29f
EvaluationProofC = 00ef808190325fb49195e5244c1477694ef2770626369dd0a
d0a428a0482ae69b837ff8e9d34e347ee8bf5e6a30d6ef7b9c8e995ef3aca5a45218
c5ff97cf4bade00
EvaluationProofS = 01b7c17f5474a7fdd637e6351566b7606e1b03ac034728e24
5a855278bc245fe2d1fb6c93180b4904f1037909d2ea8746ac806e507b7de668cc13
0de7264da4003e2
Info = 4f505246207465737420766563746f7273
Output = 474928ccc8088a22c80d2205187eed5a7e31cdbdd50528de43b306a4958
269054059ce94e242cc3d3583537c7a399a283b65219ac9e33e9d44b396a6b889e21
1,963ee0b1ed3a319a8947b9fef093ddf270628c5987cab96bff89287f81840486ad
c514c9f73568f4ac43ff84b113041137ca4837849b4bcb58c6d4c576cd4b15
</pre><a href="#section-a.5.2.3-1" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="authors-addresses">
<section id="section-appendix.b">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Alex Davidson</span></div>
<div dir="auto" class="left"><span class="org">Cloudflare</span></div>
<div dir="auto" class="left"><span class="street-address">County Hall</span></div>
<div dir="auto" class="left"><span class="locality">London, SE1 7GP</span></div>
<div dir="auto" class="left"><span class="country-name">United Kingdom</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:alex.davidson92@gmail.com" class="email">alex.davidson92@gmail.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Armando Faz-Hernandez</span></div>
<div dir="auto" class="left"><span class="org">Cloudflare</span></div>
<div dir="auto" class="left"><span class="street-address">101 Townsend St</span></div>
<div dir="auto" class="left">
<span class="locality">San Francisco</span>,  </div>
<div dir="auto" class="left"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:armfazh@cloudflare.com" class="email">armfazh@cloudflare.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Nick Sullivan</span></div>
<div dir="auto" class="left"><span class="org">Cloudflare</span></div>
<div dir="auto" class="left"><span class="street-address">101 Townsend St</span></div>
<div dir="auto" class="left">
<span class="locality">San Francisco</span>,  </div>
<div dir="auto" class="left"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:nick@cloudflare.com" class="email">nick@cloudflare.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Christopher A. Wood</span></div>
<div dir="auto" class="left"><span class="org">Cloudflare</span></div>
<div dir="auto" class="left"><span class="street-address">101 Townsend St</span></div>
<div dir="auto" class="left">
<span class="locality">San Francisco</span>,  </div>
<div dir="auto" class="left"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:caw@heapingbits.net" class="email">caw@heapingbits.net</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
